"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[28318,65800,96491],{18872:(e,t,n)=>{n.d(t,{decimals:()=>i});var o=n(72980),s=n(23281);async function i(e){return(0,o.n)(()=>(0,s.rr)(e),{cacheKey:`${e.contract.chain.id}:${e.contract.address}:decimals`,cacheTime:Number.POSITIVE_INFINITY})}},22356:(e,t,n)=>{n.d(t,{GP:()=>i,HT:()=>r,Q_:()=>a});var o=n(54924);let s={wei:0,gwei:9,szabo:12,finney:15,ether:18};function i(e,t=0){let n=e.toString(),o=n.startsWith("-");o&&(n=n.slice(1));let[s,a]=[(n=n.padStart(t,"0")).slice(0,n.length-t),n.slice(n.length-t)];return a=a.replace(/(0+)$/,""),`${o?"-":""}${s||"0"}${a?`.${a}`:""}`}function a(e,t="wei"){return i(e,s.gwei-s[t])}function r(e,t=0){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new d({value:e});let[n="",o="0"]=e.split("."),s=n.startsWith("-");if(s&&(n=n.slice(1)),o=o.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${o}`))&&(n=`${BigInt(n)+1n}`),o="";else if(o.length>t){let[e,s,i]=[o.slice(0,t-1),o.slice(t-1,t),o.slice(t)],a=Math.round(Number(`${s}.${i}`));(o=a>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${a}`).length>t&&(o=o.slice(1),n=`${BigInt(n)+1n}`),o=o.slice(0,t)}else o=o.padEnd(t,"0");return BigInt(`${s?"-":""}${n}${o}`)}class d extends o.C{constructor({value:e}){super(`Value \`${e}\` is not a valid decimal number.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Value.InvalidDecimalNumberError"})}}},28318:(e,t,n)=>{n.r(t),n.d(t,{assertInsightEnabled:()=>s,isInsightEnabled:()=>i});var o=n(23802);async function s(e){let t=await Promise.all(e.map(e=>i(e).then(t=>({chain:e,enabled:t}))));if(!t.every(e=>e.enabled))throw Error(`Insight is not available for chains ${t.filter(e=>!e.enabled).map(e=>e.chain.id).join(", ")}`)}async function i(e){return(await (0,o.MH)(e)).some(e=>"insight"===e.service&&e.enabled)}},59373:(e,t,n)=>{n.d(t,{nB:()=>a});var o=n(74340);let s=[{type:"address",name:"owner"},{type:"address",name:"spender"}],i=[{type:"uint256"}];async function a(e){return(0,o.readContract)({contract:e.contract,method:["0xdd62ed3e",s,i],params:[e.owner,e.spender]})}},65800:(e,t,n)=>{n.r(t),n.d(t,{default:()=>tY});var o=n(95155),s=n(24050),i=n(12115),a=n(33615),r=n(23802),d=n(58528),c=n(98006),l=n(14545),u=n(15156),m=n(26939),h=n(6071),p=n(51536),x=n(46257),y=n(58805),f=n(11897),g=n(96358),k=n(30462),w=n(31532),j=n(34471),T=n(96491),b=n(22367),A=n(65287),C=n(19208),v=n(88914),I=n(4580),S=n(2579),D=n(18872),E=n(99232),W=n(19131),B=n(14208),R=n(2098),L=n(74180),P=n(52669),z=n(46531),F=n(87900),q=n(38603),N=n(94689),M=n(33418);function O(e){let{payUiOptions:t,supportedDestinations:n,client:s,onContinue:i,payerAccount:r}=e,u=(0,B.QP)(),m=(0,L.z)(),h=t.metadata,x=t.paymentInfo,{data:k}=(0,R.cj)(x.chain),{data:w}=(0,P.vq)({client:s,address:x.sellerAddress}),T=(0,I.I)({queryKey:["amount",x],queryFn:async()=>{let e,t=18;return x.token&&!(0,v.rk)(x.token)&&(t=await (0,D.decimals)({contract:(0,S.P)({address:x.token.address,chain:x.chain,client:s})})),"amountWei"in x?(0,W.toTokens)(x.amountWei,t):x.amount}}).data;if(!k||void 0===T)return(0,o.jsx)(p.x,{});let A=x.token?{...x.token,icon:x.token?.icon||n.find(e=>e.chain.id===x.chain.id)?.tokens.find(e=>e.address.toLowerCase()===x.token?.address.toLowerCase())?.icon}:{address:d.DG,name:k.nativeCurrency.name,symbol:k.nativeCurrency.symbol,icon:k.icon?.url};return(0,o.jsxs)(f.mc,{px:"lg",children:[(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsx)(f.rQ,{title:h?.name||"Payment Details"}),(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsxs)(f.mc,{children:[h?.image?(0,o.jsx)(F.E,{client:s,src:h?.image,style:{width:"100%",borderRadius:l.YK.md,backgroundColor:u.colors.tertiaryBg}}):m?(0,o.jsxs)(f.mc,{flex:"row",center:"both",style:{padding:l.YK.md,marginBottom:l.YK.md,borderRadius:l.YK.md,backgroundColor:u.colors.tertiaryBg},children:[(0,o.jsx)(N.j,{size:l.RK.xl,id:m.id,client:s}),(0,o.jsx)("div",{style:{flexGrow:1,borderBottom:"6px dotted",borderColor:u.colors.secondaryIconColor,marginLeft:l.YK.md,marginRight:l.YK.md}}),(0,o.jsx)(z.P,{client:s,size:l.RK.xl,chainIconUrl:k.icon?.url})]}):null,(0,o.jsx)(y.h,{y:"md"}),(0,o.jsxs)(f.mc,{flex:"row",children:[(0,o.jsx)(f.mc,{flex:"column",expand:!0,children:(0,o.jsx)(M.E,{size:"md",color:"primaryText",weight:700,children:"Price"})}),(0,o.jsx)(f.mc,{expand:!0,children:(0,o.jsxs)(f.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,o.jsx)(q.x,{chain:x.chain,client:e.client,size:"sm",token:A}),(0,o.jsxs)(M.E,{color:"primaryText",size:"md",weight:700,children:[String((0,c.Z)(Number(T),6))," ",A.symbol]})]})})]}),(0,o.jsx)(y.h,{y:"md"}),(0,o.jsx)(f.N1,{}),(0,o.jsx)(y.h,{y:"md"}),(0,o.jsxs)(f.mc,{flex:"row",children:[(0,o.jsx)(f.mc,{flex:"column",expand:!0,children:(0,o.jsx)(M.E,{size:"xs",color:"secondaryText",children:"Network"})}),(0,o.jsx)(f.mc,{expand:!0,children:(0,o.jsxs)(f.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,o.jsx)(z.P,{chainIconUrl:k.icon?.url,size:"xs",client:e.client}),(0,o.jsx)(M.E,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:k.name})]})})]}),(0,o.jsx)(y.h,{y:"sm"}),(0,o.jsxs)(f.mc,{flex:"row",children:[(0,o.jsx)(f.mc,{flex:"column",expand:!0,children:(0,o.jsx)(M.E,{size:"xs",color:"secondaryText",children:"Seller"})}),(0,o.jsx)(f.mc,{expand:!0,children:(0,o.jsx)(f.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:(0,o.jsx)(M.E,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:w||(0,E.Wr)(x.sellerAddress)})})})]})]}),(0,o.jsx)(y.h,{y:"xl"}),r?(0,o.jsx)(g.$n,{variant:"accent",fullWidth:!0,onClick:()=>{(0,a.G)({event:"choose_payment_method_direct_payment_mode",client:s,walletAddress:r.address,walletType:m?.id,toChainId:x.chain.id,toToken:x.token?.address}),i(T,x.chain,A)},children:"Choose Payment Method"}):(0,o.jsx)("div",{children:(0,o.jsx)(j.p,{...e.connectOptions,client:s,theme:u,connectButton:{style:{width:"100%"}}})}),(0,o.jsx)(y.h,{y:"lg"}),!1!==t.showThirdwebBranding&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(b.B,{link:"https://playground.thirdweb.com/connect/pay?utm_source=ub_text"}),(0,o.jsx)(y.h,{y:"sm"})]})]})}var _=n(52686),U=n(68506),K=n(72980);async function $({client:e,originChainId:t,originTokenAddress:n}){return(0,K.n)(async()=>{let o=await U.J({client:e,originChainId:t,originTokenAddress:n,maxSteps:1,sortBy:"popularity",limit:1e6}),s=new Set,i=new Set,a=[];for(let e of o){let t=`${e.destinationToken.chainId}:${e.destinationToken.address}`;if(!s.has(t)){s.add(t),i.has(e.destinationToken.chainId)||i.add(e.destinationToken.chainId);let n=a[e.destinationToken.chainId];n||(a[e.destinationToken.chainId]=[]),a[e.destinationToken.chainId]=[...n||[],{address:_.cM(e.destinationToken.address),buyWithCryptoEnabled:!0,buyWithFiatEnabled:!0,name:e.destinationToken.name,symbol:e.destinationToken.symbol,icon:e.destinationToken.iconUri}]}}return[...i].map(e=>({chain:(0,r.Q4)(e),tokens:a[e]||[]}))},{cacheKey:`buy-supported-destinations-${t}:${n}`,cacheTime:3e5})}function G(e,t){return(0,I.I)({queryKey:["destination-tokens",e],queryFn:async()=>$({client:e})})}function H(e){let t=G(e.client),n=e.token,s=(0,v.rk)(n)?void 0:t.data?.find(t=>t.chain.id===e.chain.id)?.tokens.find(e=>(0,E.bv)(e.address)===(0,E.bv)(n.address))?.icon;return(0,o.jsx)(q.x,{token:(0,v.rk)(n)?{nativeToken:!0}:{address:n.address,icon:n.icon||s},chain:e.chain,client:e.client,size:e.size})}var Q=n(93219),Y=n(20994),V=n(65199),J=n(70134),Z=n(79968),X=n(53104);function ee(e){let{payUiOptions:t,client:n,payerAccount:s,supportedDestinations:i,onContinue:r}=e,{data:m,error:x,isLoading:k,refetch:T}=(0,R.cj)(t.transaction.chain),A=t.metadata,{data:C,error:I,isLoading:S,refetch:D}=(0,Z.s)({transaction:t.transaction,account:s,supportedDestinations:i}),E=(0,B.QP)(),N=(0,L.z)(),O=(0,u.L)(),_=(0,P.UH)(N),U=(0,Q.X)({address:O?.address,chain:t.transaction.chain,tokenAddress:(0,v.rk)(C?.token||v.gr)?void 0:C?.token.address,client:e.client},{enabled:!!C});if(S||k)return(0,o.jsx)(p.x,{});if(!O)return(0,o.jsx)(f.mc,{style:{minHeight:"350px"},fullHeight:!0,flex:"row",center:"both",children:(0,o.jsxs)(f.mc,{animate:"fadein",children:[(0,o.jsx)(y.h,{y:"xxl"}),(0,o.jsx)(f.mc,{flex:"row",center:"x",children:(0,o.jsx)(V.l,{size:l.RK["3xl"]})}),(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsx)(M.E,{center:!0,color:"primaryText",size:"md",children:"Please connect a wallet to continue"}),(0,o.jsx)(y.h,{y:"xl"}),(0,o.jsx)(f.mc,{flex:"row",center:"x",style:{width:"100%"},children:(0,o.jsx)(j.p,{client:n,theme:E,...e.connectOptions})})]})});if(I||x)return(0,o.jsx)(f.mc,{style:{minHeight:"350px"},fullHeight:!0,flex:"row",center:"both",children:(0,o.jsx)(h.W,{title:I?.message||x?.message||"Something went wrong",onTryAgain:I?D:T})});if(!C||!m)return(0,o.jsx)(p.x,{});let K=U.data&&U.data.value<C.transactionValueWei;return(0,o.jsxs)(f.mc,{px:"lg",children:[(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsx)(f.rQ,{title:A?.name||"Transaction"}),(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsxs)(f.mc,{children:[A?.image?(0,o.jsx)(F.E,{client:n,src:A?.image,style:{width:"100%",borderRadius:l.YK.md,border:`1px solid ${E.colors.borderColor}`,backgroundColor:E.colors.tertiaryBg}}):O?(0,o.jsxs)(f.mc,{flex:"column",gap:"sm",children:[K&&(0,o.jsxs)("div",{children:[(0,o.jsx)(M.E,{color:"danger",size:"xs",center:!0,multiline:!0,children:"Insufficient Funds"}),(0,o.jsx)(M.E,{size:"xs",center:!0,multiline:!0,children:"Select another token or pay with card."})]}),(0,o.jsxs)(f.mc,{flex:"row",style:{justifyContent:"space-between",padding:l.YK.sm,marginBottom:l.YK.sm,borderRadius:l.YK.md,backgroundColor:E.colors.tertiaryBg,border:`1px solid ${E.colors.borderColor}`},children:[(0,o.jsx)(X.k,{address:O?.address,iconSize:"md",client:n}),U.data?(0,o.jsxs)(f.mc,{flex:"row",gap:"3xs",center:"y",children:[(0,o.jsx)(M.E,{size:"xs",color:"secondaryText",weight:500,children:(0,J.j)(U.data,!1)}),(0,o.jsx)(w.C,{token:C.token,chain:t.transaction.chain,size:"xs",color:"secondaryText"})]}):(0,o.jsx)(Y.E,{width:"70px",height:l.J.xs})]})]}):null,(0,o.jsx)(y.h,{y:"md"}),(0,o.jsxs)(f.mc,{flex:"row",children:[(0,o.jsx)(f.mc,{flex:"column",expand:!0,children:(0,o.jsx)(M.E,{size:"md",color:"primaryText",weight:700,children:"Price"})}),(0,o.jsx)(f.mc,{expand:!0,children:(0,o.jsxs)(f.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,o.jsx)(q.x,{chain:t.transaction.chain,client:e.client,size:"sm",token:C.token}),(0,o.jsxs)(M.E,{color:"primaryText",size:"md",weight:700,children:[String((0,c.Z)(Number((0,W.toTokens)(C.transactionValueWei,C.decimals)),6))," ",C.token.symbol]})]})})]}),(0,o.jsx)(y.h,{y:"md"}),(0,o.jsx)(f.N1,{}),(0,o.jsx)(y.h,{y:"md"}),(0,o.jsxs)(f.mc,{flex:"row",children:[(0,o.jsx)(f.mc,{flex:"column",expand:!0,children:(0,o.jsx)(M.E,{size:"xs",color:"secondaryText",children:"Gas Fees"})}),(0,o.jsx)(f.mc,{expand:!0,children:(0,o.jsx)(f.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:(0,o.jsx)(M.E,{color:_?"success":"primaryText",size:"xs",children:_?"Sponsored":`${String((0,c.Z)(Number((0,W.toTokens)(C.gasCostWei,m.nativeCurrency.decimals)),6))} ${m.nativeCurrency.symbol}`})})})]}),(0,o.jsx)(y.h,{y:"sm"}),(0,o.jsxs)(f.mc,{flex:"row",children:[(0,o.jsx)(f.mc,{flex:"column",expand:!0,children:(0,o.jsx)(M.E,{size:"xs",color:"secondaryText",children:"Network"})}),(0,o.jsx)(f.mc,{expand:!0,children:(0,o.jsxs)(f.mc,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,o.jsx)(z.P,{chainIconUrl:m.icon?.url,size:"xs",client:e.client}),(0,o.jsx)(M.E,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:m.name})]})})]})]}),(0,o.jsx)(y.h,{y:"xl"}),s?(0,o.jsx)(g.$n,{variant:"accent",fullWidth:!0,onClick:()=>{let e=K?C.transactionValueWei-(U.data?.value||0n):C.transactionValueWei;C.token.address!==d.DG||_||(e+=C.gasCostWei),(0,a.G)({event:"choose_payment_method_transaction_mode",client:n,walletAddress:s.address,walletType:N?.id,toChainId:t.transaction.chain.id,toToken:C.token.address,amountWei:e.toString()}),r((0,W.toTokens)(e,C.decimals),t.transaction.chain,C.token)},children:"Choose Payment Method"}):(0,o.jsx)("div",{children:(0,o.jsx)(j.p,{...e.connectOptions,client:n,theme:E,connectButton:{style:{width:"100%"}}})}),(0,o.jsx)(y.h,{y:"lg"}),!1!==t.showThirdwebBranding&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(b.B,{link:"https://playground.thirdweb.com/connect/pay?utm_source=ub_text"}),(0,o.jsx)(y.h,{y:"sm"})]})]})}var et=n(29611);let en={shorthand:"USD",countryCode:"US",name:"US Dollar",symbol:"$",icon:e=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:e.size,height:e.size,x:"0px",y:"0px",viewBox:"0 0 512 512","aria-hidden":"true",children:[(0,o.jsx)("circle",{fill:"#F0F0F0",cx:"256",cy:"256",r:"256"}),(0,o.jsxs)("g",{children:[(0,o.jsx)("path",{fill:"#D80027",d:"M244.87,256H512c0-23.106-3.08-45.49-8.819-66.783H244.87V256z"}),(0,o.jsx)("path",{fill:"#D80027",d:"M244.87,122.435h229.556c-15.671-25.572-35.708-48.175-59.07-66.783H244.87V122.435z"}),(0,o.jsx)("path",{fill:"#D80027",d:"M256,512c60.249,0,115.626-20.824,159.356-55.652H96.644C140.374,491.176,195.751,512,256,512z"}),(0,o.jsx)("path",{fill:"#D80027",d:"M37.574,389.565h436.852c12.581-20.529,22.338-42.969,28.755-66.783H8.819   C15.236,346.596,24.993,369.036,37.574,389.565z"})]}),(0,o.jsx)("path",{fill:"#0052B4",d:"M118.584,39.978h23.329l-21.7,15.765l8.289,25.509l-21.699-15.765L85.104,81.252l7.16-22.037  C73.158,75.13,56.412,93.776,42.612,114.552h7.475l-13.813,10.035c-2.152,3.59-4.216,7.237-6.194,10.938l6.596,20.301l-12.306-8.941  c-3.059,6.481-5.857,13.108-8.372,19.873l7.267,22.368h26.822l-21.7,15.765l8.289,25.509l-21.699-15.765l-12.998,9.444  C0.678,234.537,0,245.189,0,256h256c0-141.384,0-158.052,0-256C205.428,0,158.285,14.67,118.584,39.978z M128.502,230.4  l-21.699-15.765L85.104,230.4l8.289-25.509l-21.7-15.765h26.822l8.288-25.509l8.288,25.509h26.822l-21.7,15.765L128.502,230.4z   M120.213,130.317l8.289,25.509l-21.699-15.765l-21.699,15.765l8.289-25.509l-21.7-15.765h26.822l8.288-25.509l8.288,25.509h26.822  L120.213,130.317z M220.328,230.4l-21.699-15.765L176.93,230.4l8.289-25.509l-21.7-15.765h26.822l8.288-25.509l8.288,25.509h26.822  l-21.7,15.765L220.328,230.4z M212.039,130.317l8.289,25.509l-21.699-15.765l-21.699,15.765l8.289-25.509l-21.7-15.765h26.822  l8.288-25.509l8.288,25.509h26.822L212.039,130.317z M212.039,55.743l8.289,25.509l-21.699-15.765L176.93,81.252l8.289-25.509  l-21.7-15.765h26.822l8.288-25.509l8.288,25.509h26.822L212.039,55.743z"})]})},eo=[en,{shorthand:"CAD",countryCode:"CA",name:"Canadian Dollar",symbol:"$",icon:e=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:e.size,height:e.size,viewBox:"0 0 512 512","aria-hidden":"true",children:[(0,o.jsx)("mask",{id:"a",children:(0,o.jsx)("circle",{cx:"256",cy:"256",r:"256",fill:"#fff"})}),(0,o.jsxs)("g",{mask:"url(#a)",children:[(0,o.jsx)("path",{fill:"#d80027",d:"M0 0v512h144l112-64 112 64h144V0H368L256 64 144 0Z"}),(0,o.jsx)("path",{fill:"#eee",d:"M144 0h224v512H144Z"}),(0,o.jsx)("path",{fill:"#d80027",d:"m301 289 44-22-22-11v-22l-45 22 23-44h-23l-22-34-22 33h-23l23 45-45-22v22l-22 11 45 22-12 23h45v33h22v-33h45z"})]})]})},{shorthand:"GBP",countryCode:"GB",name:"British Pound",symbol:"\xa3",icon:e=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",id:"Layer_1",x:"0px",y:"0px",width:e.size,height:e.size,viewBox:"0 0 512 512","aria-hidden":"true",children:[(0,o.jsx)("circle",{fill:"#F0F0F0",cx:"256",cy:"256",r:"256"}),(0,o.jsxs)("g",{children:[(0,o.jsx)("path",{fill:"#0052B4",d:"M52.92,100.142c-20.109,26.163-35.272,56.318-44.101,89.077h133.178L52.92,100.142z"}),(0,o.jsx)("path",{fill:"#0052B4",d:"M503.181,189.219c-8.829-32.758-23.993-62.913-44.101-89.076l-89.075,89.076H503.181z"}),(0,o.jsx)("path",{fill:"#0052B4",d:"M8.819,322.784c8.83,32.758,23.993,62.913,44.101,89.075l89.074-89.075L8.819,322.784L8.819,322.784   z"}),(0,o.jsx)("path",{fill:"#0052B4",d:"M411.858,52.921c-26.163-20.109-56.317-35.272-89.076-44.102v133.177L411.858,52.921z"}),(0,o.jsx)("path",{fill:"#0052B4",d:"M100.142,459.079c26.163,20.109,56.318,35.272,89.076,44.102V370.005L100.142,459.079z"}),(0,o.jsx)("path",{fill:"#0052B4",d:"M189.217,8.819c-32.758,8.83-62.913,23.993-89.075,44.101l89.075,89.075V8.819z"}),(0,o.jsx)("path",{fill:"#0052B4",d:"M322.783,503.181c32.758-8.83,62.913-23.993,89.075-44.101l-89.075-89.075V503.181z"}),(0,o.jsx)("path",{fill:"#0052B4",d:"M370.005,322.784l89.075,89.076c20.108-26.162,35.272-56.318,44.101-89.076H370.005z"})]}),(0,o.jsxs)("g",{children:[(0,o.jsx)("path",{fill:"#D80027",d:"M509.833,222.609h-220.44h-0.001V2.167C278.461,0.744,267.317,0,256,0   c-11.319,0-22.461,0.744-33.391,2.167v220.44v0.001H2.167C0.744,233.539,0,244.683,0,256c0,11.319,0.744,22.461,2.167,33.391   h220.44h0.001v220.442C233.539,511.256,244.681,512,256,512c11.317,0,22.461-0.743,33.391-2.167v-220.44v-0.001h220.442   C511.256,278.461,512,267.319,512,256C512,244.683,511.256,233.539,509.833,222.609z"}),(0,o.jsx)("path",{fill:"#D80027",d:"M322.783,322.784L322.783,322.784L437.019,437.02c5.254-5.252,10.266-10.743,15.048-16.435   l-97.802-97.802h-31.482V322.784z"}),(0,o.jsx)("path",{fill:"#D80027",d:"M189.217,322.784h-0.002L74.98,437.019c5.252,5.254,10.743,10.266,16.435,15.048l97.802-97.804   V322.784z"}),(0,o.jsx)("path",{fill:"#D80027",d:"M189.217,189.219v-0.002L74.981,74.98c-5.254,5.252-10.266,10.743-15.048,16.435l97.803,97.803   H189.217z"}),(0,o.jsx)("path",{fill:"#D80027",d:"M322.783,189.219L322.783,189.219L437.02,74.981c-5.252-5.254-10.743-10.266-16.435-15.047   l-97.802,97.803V189.219z"})]})]})},{shorthand:"EUR",countryCode:"EU",name:"Euro",symbol:"€",icon:e=>(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:e.size,height:e.size,viewBox:"0 0 512 512","aria-hidden":"true",children:[(0,o.jsx)("mask",{id:"a",children:(0,o.jsx)("circle",{cx:"256",cy:"256",r:"256",fill:"#fff"})}),(0,o.jsxs)("g",{mask:"url(#a)",children:[(0,o.jsx)("path",{fill:"#0052b4",d:"M0 0h512v512H0z"}),(0,o.jsx)("path",{fill:"#ffda44",d:"m256 100.2 8.3 25.5H291l-21.7 15.7 8.3 25.6-21.7-15.8-21.7 15.8 8.3-25.6-21.7-15.7h26.8zm-110.2 45.6 24 12.2 18.9-19-4.2 26.5 23.9 12.2-26.5 4.2-4.2 26.5-12.2-24-26.5 4.3 19-19zM100.2 256l25.5-8.3V221l15.7 21.7 25.6-8.3-15.8 21.7 15.8 21.7-25.6-8.3-15.7 21.7v-26.8zm45.6 110.2 12.2-24-19-18.9 26.5 4.2 12.2-23.9 4.2 26.5 26.5 4.2-24 12.2 4.3 26.5-19-19zM256 411.8l-8.3-25.5H221l21.7-15.7-8.3-25.6 21.7 15.8 21.7-15.8-8.3 25.6 21.7 15.7h-26.8zm110.2-45.6-24-12.2-18.9 19 4.2-26.5-23.9-12.2 26.5-4.2 4.2-26.5 12.2 24 26.5-4.3-19 19zM411.8 256l-25.5 8.3V291l-15.7-21.7-25.6 8.3 15.8-21.7-15.8-21.7 25.6 8.3 15.7-21.7v26.8zm-45.6-110.2-12.2 24 19 18.9-26.5-4.2-12.2 23.9-4.2-26.5-26.5-4.2 24-12.2-4.3-26.5 19 19z"})]})]})},{shorthand:"JPY",countryCode:"JP",name:"Japanese Yen",symbol:"\xa5",icon:e=>(0,o.jsx)("svg",{width:e.size,height:e.size,viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",role:"presentation",children:(0,o.jsxs)("g",{fill:"none",fillRule:"evenodd",children:[(0,o.jsx)("circle",{cx:"16",cy:"16",fill:"#a81b1b",r:"16"}),(0,o.jsx)("path",{d:"M17.548 18.711v1.878h5.063v2.288h-5.063V25.5h-3.096v-2.623H9.389v-2.288h5.063v-1.878H9.389v-2.288h4.171L7.5 7.5h3.752l4.8 7.534L20.853 7.5H24.5l-6.086 8.923h4.197v2.288z",fill:"#ffffff"})]})})},{shorthand:"AUD",countryCode:"AU",name:"Australian Dollar",symbol:"$"},{shorthand:"NZD",countryCode:"NZ",name:"New Zealand Dollar",symbol:"$"}];function es(e,t){return e.icon?(0,o.jsx)(e.icon,{size:l.RK[t]}):(0,o.jsx)("img",{src:`https://flagsapi.com/${e.countryCode.toUpperCase()}/flat/64.png`,alt:e.shorthand,width:l.RK[t],height:l.RK[t]})}function ei(e){return(0,o.jsxs)(f.mc,{children:[(0,o.jsx)(f.mc,{p:"lg",children:(0,o.jsx)(f.rQ,{title:"Pay with",onBack:e.onBack})}),(0,o.jsx)(f.N1,{}),(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsx)(f.mc,{flex:"column",gap:"xs",px:"lg",children:eo.map(t=>(0,o.jsxs)(ea,{fullWidth:!0,variant:"secondary",onClick:()=>e.onSelect(t),gap:"sm",children:[es(t,"lg"),(0,o.jsxs)(f.mc,{flex:"column",gap:"xxs",children:[(0,o.jsx)(M.E,{color:"primaryText",children:t.shorthand}),(0,o.jsx)(M.E,{size:"sm",children:t.name})]})]},t.shorthand))}),(0,o.jsx)(y.h,{y:"lg"})]})}let ea=(0,et.A)(g.$n)(()=>{let e=(0,B.QP)();return{background:e.colors.tertiaryBg,justifyContent:"flex-start",gap:l.YK.sm,padding:l.YK.sm,"&:hover":{background:e.colors.secondaryButtonBg,transform:"scale(1.01)"},transition:"background 200ms ease, transform 150ms ease"}}),er=["COINBASE","STRIPE","TRANSAK"];var ed=n(17273),ec=n(98864),el=n(8118),eu=n(35581);async function em(e){let{client:t,onramp:n,chainId:o,tokenAddress:s,receiver:i,amount:a,purchaseData:r,sender:d,onrampTokenAddress:c,onrampChainId:l,currency:u,maxSteps:m,excludeChainIds:h,paymentLinkId:p}=e,x=(0,ec.getClientFetch)(t),y=`${(0,ed.getThirdwebBaseUrl)("bridge")}/v1/onramp/prepare`,f={onramp:n,chainId:Number(o),tokenAddress:s,receiver:i};void 0!==a&&(f.amount=a.toString()),void 0!==r&&(f.purchaseData=r),void 0!==d&&(f.sender=d),void 0!==c&&(f.onrampTokenAddress=c),void 0!==l&&(f.onrampChainId=Number(l)),void 0!==u&&(f.currency=u),void 0!==m&&(f.maxSteps=m),void 0!==h&&(f.excludeChainIds=Array.isArray(h)?h.join(","):h),void 0!==p&&(f.paymentLinkId=p);let g=await x(y,{method:"POST",headers:{"Content-Type":"application/json"},body:(0,el.stringify)(f)});if(!g.ok){let e=await g.json();throw new eu.h({code:e.code||"UNKNOWN_ERROR",message:e.message||g.statusText,correlationId:e.correlationId||void 0,statusCode:g.status})}let{data:k}=await g.json(),w=k.steps.map(e=>({...e,originAmount:BigInt(e.originAmount),destinationAmount:BigInt(e.destinationAmount),transactions:e.transactions.map(e=>({...e,value:e.value?BigInt(e.value):void 0}))})),j={...k.intent,amount:k.intent.amount?k.intent.amount:void 0};return{...k,destinationAmount:BigInt(k.destinationAmount),steps:w,intent:j}}async function eh(e){try{let t,n=(e=>{switch(e){case"STRIPE":return"stripe";case"TRANSAK":return"transak";default:return"coinbase"}})(e.preferredProvider),o=e.toTokenAddress!==d.DG?await (0,D.decimals)({contract:(0,S.P)({client:e.client,address:e.toTokenAddress,chain:(0,r.Q4)(e.toChainId)})}):18,s=e.toAmount?(0,W.J1)(e.toAmount,o):void 0,i=await em({client:e.client,onramp:n,chainId:e.toChainId,tokenAddress:e.toTokenAddress,receiver:e.toAddress,sender:e.fromAddress,amount:s,purchaseData:e.purchaseData,currency:e.fromCurrencySymbol,maxSteps:2,onrampTokenAddress:d.DG,paymentLinkId:e.paymentLinkId}),a=i.steps.length>0?i.steps[0]:void 0,c=Math.max(120,Math.ceil(i.steps.reduce((e,t)=>e+t.estimatedExecutionTimeMs,0)/1e3)),l=i.destinationAmount,u=e.maxSlippageBPS??0,m=l*BigInt(u)/10000n,h=l-m,p=(0,W.toTokens)(l,o),x=(0,W.toTokens)(h,o),y=e=>({chainId:e.chainId,tokenAddress:e.address,decimals:e.decimals,priceUSDCents:Math.round(100*e.priceUsd),name:e.name,symbol:e.symbol}),f=i.destinationToken,g=i.steps.length>0&&a?a.originToken:f,k=i.steps.length>1?i.steps[1].originToken:void 0,w=i.steps.length>0&&a?a.originAmount:i.destinationAmount,j=(0,W.toTokens)(w,g.decimals),T={amount:j,amountWei:w.toString(),amountUSDCents:Math.round(Number(j)*g.priceUsd*100),token:y(g)};if(k){let e=i.steps[1].originAmount,n=(0,W.toTokens)(e,k.decimals);t={amount:n,amountWei:e.toString(),amountUSDCents:Math.round(Number(n)*k.priceUsd*100),token:y(k)}}return{estimatedDurationSeconds:c,estimatedToAmountMin:p,estimatedToAmountMinWei:l.toString(),toAmountMinWei:h.toString(),toAmountMin:x,fromCurrency:{amount:i.currencyAmount.toString(),amountUnits:Number(i.currencyAmount).toFixed(2),decimals:2,currencySymbol:i.currency},fromCurrencyWithFees:{amount:i.currencyAmount.toString(),amountUnits:Number(i.currencyAmount).toFixed(2),decimals:2,currencySymbol:i.currency},toToken:y(f),toAddress:e.toAddress,fromAddress:e.fromAddress,maxSlippageBPS:u,intentId:i.id,processingFees:[],onRampToken:T,routingToken:t,onRampLink:i.link,provider:e.preferredProvider??"COINBASE"}}catch(e){throw console.error("Error getting buy with fiat quote",e),e}}var ep=n(4161);function ex(e){if(e instanceof eu.h){let t;return"INTERNAL_SERVER_ERROR"===e.code?{code:"INTERNAL_SERVER_ERROR",title:"Failed to Find Quote",message:"An unknown error occurred. Please try again."}:{code:e.code,title:"Failed to Find Quote",message:((t=e.message).includes("Details")&&(t=t.substring(0,t.indexOf("Details"))),t.includes("{")&&(t=t.substring(0,t.indexOf("{"))),t)}}return{code:"UNABLE_TO_GET_PRICE_QUOTE",title:"Failed to Find Quote",message:e.message||"We couldn't get a quote for this token pair. Select another token or pay with card."}}var ey=n(15933),ef=n(13380),eg=n(33096),ek=n(94562),ew=n(5216),ej=n(27161),eT=n(59750);function eb(){let e=(0,ey._)(["\n  from {\n    opacity: 0;\n    transform: translateY(100px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n"]);return eb=function(){return e},e}let eA=(0,i.forwardRef)(function(e,t){return(0,o.jsx)(eC,{ref:t,children:(0,o.jsx)(ej.X,{children:(0,o.jsxs)(f.mc,{p:"lg",children:[(0,o.jsx)(eT.w,{children:(0,o.jsx)(g.K0,{type:"button","aria-label":"Close",onClick:e.close,children:(0,o.jsx)(eg.MKb,{width:l.RK.md,height:l.RK.md,style:{color:"inherit"}})})}),e.children]})})})}),eC=(0,ew.jx)(e=>{let t=(0,B.QP)();return{zIndex:1e4,borderTopLeftRadius:l.r8.xl,borderTopRightRadius:l.r8.xl,background:t.colors.modalBg,position:"absolute",bottom:0,left:0,right:0,animation:"".concat(ev," 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.1)"),borderTop:"1px solid ".concat(t.colors.borderColor)}}),ev=(0,ef.i7)(eb()),eI=(0,ew.jx)(e=>({backgroundColor:(0,B.QP)().colors.modalOverlayBg,zIndex:9999,position:"absolute",inset:0,animation:"".concat(ek.I0," 400ms cubic-bezier(0.16, 1, 0.3, 1)")}));function eS(){let[e,t]=(0,i.useState)(!1),n=(0,i.useRef)(null),o=(0,i.useRef)(null),s=(0,i.useCallback)(()=>new Promise(e=>{if(n.current){var t;let s={easing:"cubic-bezier(0.175, 0.885, 0.32, 1.1)",fill:"forwards",duration:300},i=n.current.animate([{transform:"translateY(100%)",opacity:0}],s);null==(t=o.current)||t.animate([{opacity:0}],s),i.onfinish=()=>e()}else e()}),[]),a=(0,i.useCallback)(async e=>{e?t(!0):(await s(),t(!1))},[s]);return(0,i.useLayoutEffect)(()=>{if(!e)return;let t=e=>{n.current&&e.target instanceof Node&&!n.current.contains(e.target)&&a(!1)};return requestAnimationFrame(()=>{document.addEventListener("click",t)}),()=>{document.removeEventListener("click",t)}},[e,a]),{drawerRef:n,drawerOverlayRef:o,setIsOpen:a,isOpen:e}}var eD=n(30014);function eE(e){let{estimatedSeconds:t,quoteIsLoading:n}=e;return(0,o.jsxs)(f.mc,{bg:"tertiaryBg",flex:"row",borderColor:"borderColor",style:{borderRadius:l.r8.md,borderTopLeftRadius:0,borderTopRightRadius:0,justifyContent:"space-between",alignItems:"center",borderWidth:"1px",borderStyle:"solid"},children:[(0,o.jsxs)(f.mc,{flex:"row",center:"y",gap:"xxs",color:"accentText",p:"sm",children:[(0,o.jsx)(eg.O4,{width:l.RK.sm,height:l.RK.sm}),n?(0,o.jsx)(Y.E,{height:l.J.xs,width:"50px",color:"borderColor"}):(0,o.jsx)(M.E,{size:"xs",color:"secondaryText",children:void 0!==t?`~${function(e){if(e>3600){let t=Math.floor(e/3600),n=Math.floor(e%3600/60);return`${t} Hours ${n} Minutes`}if(e>60){let t=Math.ceil(e/60);return`${t} Minutes`}return`${e}s`}(t)}`:"--"})]}),(0,o.jsxs)(g.$n,{variant:"ghost",onClick:e.onViewFees,gap:"xs",children:[(0,o.jsx)(f.mc,{color:"accentText",flex:"row",center:"both",children:(0,o.jsx)(eW,{size:l.RK.sm})}),(0,o.jsx)(M.E,{size:"xs",color:"secondaryText",children:"View Fees"})]})]})}let eW=e=>(0,o.jsxs)("svg",{width:e.size,height:e.size,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M9.5 1.5H2.5C1.94772 1.5 1.5 1.94772 1.5 2.5V9.5C1.5 10.0523 1.94772 10.5 2.5 10.5H9.5C10.0523 10.5 10.5 10.0523 10.5 9.5V2.5C10.5 1.94772 10.0523 1.5 9.5 1.5Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M4.5 7.5L7.5 4.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]});function eB(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}let eR=e=>{let t=(0,o.jsxs)(f.mc,{flex:"row",center:"y",gap:"xxs",color:"secondaryText",style:{padding:l.YK.md},children:[(0,o.jsx)(M.E,{size:"xs",children:eB(e.preferredProvider??e.quotedProvider??"")}),e.supportedProviders.length>1&&(0,o.jsx)(eg.D3D,{width:l.RK.sm,height:l.RK.sm})]});return(0,o.jsxs)(f.mc,{bg:"tertiaryBg",flex:"row",borderColor:"borderColor",style:{paddingLeft:l.YK.md,justifyContent:"space-between",alignItems:"center",borderWidth:"1px",borderStyle:"solid",borderBottom:"none"},children:[(0,o.jsx)(M.E,{size:"xs",color:"secondaryText",children:"Provider"}),e.supportedProviders.length>1?(0,o.jsx)(g.$n,{variant:"ghost",onClick:e.onShowProviders,style:{padding:0},children:t}):t]})};function eL(e){return(0,o.jsxs)(f.mc,{bg:"tertiaryBg",borderColor:"borderColor",flex:"row",style:{borderRadius:l.r8.md,borderBottomRightRadius:0,borderBottomLeftRadius:0,borderWidth:"1px",borderStyle:"solid",borderBottom:"none",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)(eP,{variant:"ghost",onClick:e.onSelectCurrency,style:{minHeight:"64px",justifyContent:"flex-start",minWidth:"50%"},gap:"sm",children:[es(e.currency,"md"),(0,o.jsxs)(f.mc,{flex:"row",center:"y",gap:"xxs",color:"secondaryText",children:[(0,o.jsx)(M.E,{color:"primaryText",children:e.currency.shorthand}),(0,o.jsx)(eg.D3D,{width:l.RK.sm,height:l.RK.sm})]})]}),(0,o.jsx)("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:l.YK.xxs,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",justifyContent:"center",paddingRight:l.YK.sm},children:e.isLoading?(0,o.jsx)(Y.E,{width:"100px",height:l.J.lg}):(0,o.jsx)(M.E,{size:"lg",color:e.value?"primaryText":"secondaryText",children:e.value?`${e.currency.symbol}${(0,c.Z)(Number(e.value),2)}`:"--"})})]})}let eP=(0,et.A)(g.$n)(()=>({"&[disabled]:hover":{borderColor:"transparent"}}));function ez(e){return(0,o.jsx)(f.mc,{flex:"column",gap:"xs",style:{alignItems:"flex-start"},children:e.quote.processingFees.map(e=>{let t=(0,c.Z)(Number(e.amount),6);return(0,o.jsxs)(f.mc,{flex:"row",gap:"xxs",children:[(0,o.jsxs)(M.E,{color:"primaryText",size:"sm",children:[0===t?"~":"",t," ",e.token.symbol]}),(0,o.jsxs)(M.E,{color:"secondaryText",size:"sm",children:["($",(e.amountUSDCents/100).toFixed(2),")"]})]},`${e.token.chainId}_${e.token.tokenAddress}_${t}`)})})}function eF(e){return(0,o.jsxs)(f.mc,{flex:"column",gap:"xs",children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,o.jsx)(M.E,{inline:!0,color:"secondaryText",children:"Amount"}),(0,o.jsxs)(M.E,{color:"primaryText",inline:!0,children:[(0,c.Z)(Number(e.quote.fromCurrency.amount),2)," ",e.quote.fromCurrency.currencySymbol]})]}),e.quote.processingFees.map((e,t)=>{let n=(0,c.Z)(Number(e.amount),6);return(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,o.jsx)(M.E,{inline:!0,color:"secondaryText",children:"NETWORK"===e.feeType?"Network Fee":"Processing Fee"}),(0,o.jsxs)(M.E,{color:"primaryText",inline:!0,children:[0===n?"~":""," ",n," ",e.currencySymbol]})]},t)}),(0,o.jsx)(y.h,{y:"xxs"}),(0,o.jsx)(f.N1,{}),(0,o.jsx)(y.h,{y:"xxs"}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,o.jsx)(M.E,{inline:!0,color:"secondaryText",children:"Total"}),(0,o.jsxs)(M.E,{color:"primaryText",inline:!0,children:[(0,c.Z)(Number(e.quote.fromCurrencyWithFees.amount),6)," ",e.quote.fromCurrencyWithFees.currencySymbol]})]})]})}function eq(e){return(0,o.jsx)(f.mc,{expand:!0,flex:"column",gap:"sm",style:{alignItems:"flex-start"},children:e.supportedProviders.map(t=>(0,o.jsx)(f.mc,{flex:"row",expand:!0,style:{justifyContent:"space-between"},children:(0,o.jsx)(g.$n,{fullWidth:!0,onClick:()=>e.onSelect(t),variant:"link",children:(0,o.jsx)(M.N,{color:e.preferredProvider===t?"primaryText":"secondaryText",size:"sm",hoverColor:"primaryText",children:eB(t)})})},t))})}function eN(e){var t;let{toToken:n,tokenAmount:s,payer:r,client:c,setScreen:l,toChain:u,showCurrencySelector:m,selectedCurrency:h,paymentLinkId:p}=e,x=e.payOptions?.paymentInfo?.sellerAddress||e.payer.account.address,{drawerRef:k,drawerOverlayRef:w,isOpen:j,setIsOpen:T}=eS(),[b,A]=(0,i.useState)("fees"),C=e.payOptions.buyWithFiat,[S,D]=(0,i.useState)(!1!==C?C?.preferredProvider||(localStorage.getItem(ep.pZ)??void 0):void 0),E=(()=>{if(!C)return[...er];let e=C?.supportedProviders??[];return Array.from(e.length>0?new Set([...S?[S]:[],...e]):er)})(),W=(t=!1!==C&&s?{fromCurrencySymbol:h.shorthand,toChainId:u.id,toAddress:x,toTokenAddress:(0,v.rk)(n)?d.DG:n.address,toAmount:s,client:c,isTestMode:C?.testMode,purchaseData:e.payOptions.purchaseData,fromAddress:r.account.address,paymentLinkId:p,preferredProvider:S??E[0]}:void 0,(0,I.I)({...void 0,queryKey:["useBuyWithFiatQuote",t],queryFn:async()=>{if(!t)throw Error("No params provided");return eh(t)},enabled:!!t,retry:!1})),B=!W.data,R=!W.isLoading&&W.error?ex(W.error):void 0;return(0,o.jsxs)(f.mc,{flex:"column",gap:"lg",animate:"fadein",children:[j&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eI,{ref:w}),(0,o.jsxs)(eA,{ref:k,close:()=>T(!1),children:["fees"===b&&W.data&&(0,o.jsxs)("div",{children:[(0,o.jsx)(M.E,{size:"lg",color:"primaryText",children:"Fees"}),(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsx)(eF,{quote:W.data})]}),"providers"===b&&(0,o.jsxs)("div",{children:[(0,o.jsx)(M.E,{size:"lg",color:"primaryText",children:"Providers"}),(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsx)(eq,{supportedProviders:E,preferredProvider:S||W.data?.provider,onSelect:e=>{D(e),localStorage.setItem(ep.pZ,e),T(!1)}})]})]})]}),(0,o.jsxs)(f.mc,{flex:"column",gap:"sm",children:[(0,o.jsx)(M.E,{size:"sm",children:"Pay with card"}),(0,o.jsxs)("div",{children:[(0,o.jsx)(eL,{isLoading:W.isLoading,value:W.data?.fromCurrencyWithFees.amount,client:c,currency:h,onSelectCurrency:m}),(0,o.jsx)(eR,{onShowProviders:function(){A("providers"),T(!0)},quotedProvider:W.data?.provider,preferredProvider:S,supportedProviders:E}),(0,o.jsx)(eE,{quoteIsLoading:W.isLoading,estimatedSeconds:W.data?.estimatedDurationSeconds,onViewFees:function(){W.data&&(A("fees"),T(!0))}})]}),R&&(0,o.jsxs)("div",{children:[(0,o.jsx)(M.E,{color:"danger",size:"xs",center:!0,multiline:!0,children:R.title}),(0,o.jsx)(M.E,{size:"xs",center:!0,multiline:!0,children:R.message})]})]}),(0,o.jsx)(g.$n,{variant:B?"outline":"accent","data-disabled":B,disabled:B,fullWidth:!0,onClick:()=>{(0,a.G)({event:"confirm_onramp_quote",client:c,walletAddress:r.account.address,walletType:r.wallet.id,toChainId:u.id,toToken:(0,v.rk)(n)?void 0:n.address}),W.data&&l({id:"fiat-flow",quote:W.data})},gap:"xs",children:W.isLoading?(0,o.jsxs)(o.Fragment,{children:["Getting price quote",(0,o.jsx)(eD.y,{size:"sm",color:"accentButtonText"})]}):"Continue"})]})}var eM=n(13525),eO=n(59373),e_=n(91764),eU=n(22356),eK=n(51879);async function e$(e){let{originChainId:t,originTokenAddress:n,destinationChainId:o,destinationTokenAddress:s,sender:i,receiver:a,client:d,amount:c,purchaseData:l,maxSteps:u,paymentLinkId:m}=e,h=(0,ec.getClientFetch)(d),p=new URL(`${(0,ed.getThirdwebBaseUrl)("bridge")}/v1/buy/prepare`),x=await h(p.toString(),{method:"POST",headers:{"Content-Type":"application/json"},body:(0,el.stringify)({buyAmountWei:c.toString(),amount:c.toString(),originChainId:t.toString(),originTokenAddress:n,destinationChainId:o.toString(),destinationTokenAddress:s,sender:i,receiver:a,purchaseData:l,maxSteps:u,paymentLinkId:m})});if(!x.ok){let e=await x.json();throw new eu.h({code:e.code||"UNKNOWN_ERROR",message:e.message||x.statusText,correlationId:e.correlationId||void 0,statusCode:x.status})}let{data:y}=await x.json();return{originAmount:BigInt(y.originAmount),destinationAmount:BigInt(y.destinationAmount),blockNumber:y.blockNumber?BigInt(y.blockNumber):void 0,timestamp:y.timestamp,estimatedExecutionTimeMs:y.estimatedExecutionTimeMs,steps:y.steps.map(e=>({...e,transactions:e.transactions.map(e=>({...e,value:e.value?BigInt(e.value):void 0,client:d,chain:(0,r.xH)(e.chainId)}))})),intent:{originChainId:t,originTokenAddress:n,destinationChainId:o,destinationTokenAddress:s,amount:c,sender:i,receiver:a}}}async function eG(e){let{originChainId:t,originTokenAddress:n,destinationChainId:o,destinationTokenAddress:s,amount:i,sender:a,receiver:d,client:c,purchaseData:l,maxSteps:u,paymentLinkId:m}=e,h=(0,ec.getClientFetch)(c),p=new URL(`${(0,ed.getThirdwebBaseUrl)("bridge")}/v1/sell/prepare`),x=await h(p.toString(),{method:"POST",headers:{"Content-Type":"application/json"},body:(0,el.stringify)({sellAmountWei:i.toString(),amount:i.toString(),originChainId:t.toString(),originTokenAddress:n,destinationChainId:o.toString(),destinationTokenAddress:s,sender:a,receiver:d,purchaseData:l,maxSteps:u,paymentLinkId:m})});if(!x.ok){let e=await x.json();throw new eu.h({code:e.code||"UNKNOWN_ERROR",message:e.message||x.statusText,correlationId:e.correlationId||void 0,statusCode:x.status})}let{data:y}=await x.json();return{originAmount:BigInt(y.originAmount),destinationAmount:BigInt(y.destinationAmount),blockNumber:y.blockNumber?BigInt(y.blockNumber):void 0,timestamp:y.timestamp,estimatedExecutionTimeMs:y.estimatedExecutionTimeMs,steps:y.steps.map(e=>({...e,transactions:e.transactions.map(e=>({...e,value:e.value?BigInt(e.value):void 0,client:c,chain:(0,r.xH)(e.chainId)}))})),expiration:y.expiration,intent:{originChainId:t,originTokenAddress:n,destinationChainId:o,destinationTokenAddress:s,amount:i,sender:a,receiver:d,purchaseData:l}}}async function eH(e){try{let t,n=await (async()=>{if(e.toAmount){let t=(0,S.P)({address:e.toTokenAddress,chain:(0,r.Q4)(e.toChainId),client:e.client}),n=t.address.toLowerCase()===d.DG?18:await (0,D.decimals)({contract:t}),o=eU.HT(e.toAmount,n);return e$({sender:e.fromAddress,receiver:e.toAddress,originChainId:e.fromChainId,originTokenAddress:e.fromTokenAddress,destinationChainId:e.toChainId,destinationTokenAddress:e.toTokenAddress,amount:o,purchaseData:e.purchaseData,client:e.client,paymentLinkId:e.paymentLinkId})}if(e.fromAmount){let t=(0,S.P)({address:e.fromTokenAddress,chain:(0,r.Q4)(e.fromChainId),client:e.client}),n=await (0,D.decimals)({contract:t}),o=eU.HT(e.fromAmount,n);return eG({sender:e.fromAddress,receiver:e.toAddress,originChainId:e.fromChainId,originTokenAddress:e.fromTokenAddress,destinationChainId:e.toChainId,destinationTokenAddress:e.toTokenAddress,amount:o,purchaseData:e.purchaseData,client:e.client,paymentLinkId:e.paymentLinkId})}throw Error("Invalid quote request, must provide either `fromAmount` or `toAmount`")})(),o=n.steps[0];if(!o)throw Error("This quote is incompatible with getBuyWithCryptoQuote. Please use Bridge.Buy.prepare instead.");let s=o.transactions.filter(e=>"approval"===e.action);if(s.length>1)throw Error("This quote is incompatible with getBuyWithCryptoQuote. Please use Bridge.Buy.prepare instead.");let i=s[0],a=o.transactions.filter(e=>"approval"!==e.action);if(a.length>1)throw Error("This quote is incompatible with getBuyWithCryptoQuote. Please use Bridge.Buy.prepare instead.");let c=a[0];if(!c)throw Error("This quote is incompatible with getBuyWithCryptoQuote. Please use Bridge.Buy.prepare instead.");if(i){let e=eK.HT(["function approve(address spender, uint256 amount)"]),[n,s]=eK.Hw(e,i.data);t={chainId:o.originToken.chainId,tokenAddress:o.originToken.address,spenderAddress:n,amountWei:s.toString()}}return{transactionRequest:{...c,extraGas:50000n},approvalData:t,swapDetails:{fromAddress:n.intent.sender,toAddress:n.intent.receiver,fromToken:{tokenAddress:o.originToken.address,chainId:o.originToken.chainId,decimals:o.originToken.decimals,symbol:o.originToken.symbol,name:o.originToken.name,priceUSDCents:100*o.originToken.priceUsd},toToken:{tokenAddress:o.destinationToken.address,chainId:o.destinationToken.chainId,decimals:o.destinationToken.decimals,symbol:o.destinationToken.symbol,name:o.destinationToken.name,priceUSDCents:100*o.destinationToken.priceUsd},fromAmount:eU.GP(n.originAmount,o.originToken.decimals).toString(),fromAmountWei:n.originAmount.toString(),toAmountMinWei:n.destinationAmount.toString(),toAmountMin:eU.GP(n.destinationAmount,o.destinationToken.decimals).toString(),toAmountWei:n.destinationAmount.toString(),toAmount:eU.GP(n.destinationAmount,o.destinationToken.decimals).toString(),estimated:{fromAmountUSDCents:Number(eU.GP(n.originAmount,o.originToken.decimals))*o.originToken.priceUsd*100,toAmountMinUSDCents:Number(eU.GP(n.destinationAmount,o.destinationToken.decimals))*o.destinationToken.priceUsd*100,toAmountUSDCents:Number(eU.GP(n.destinationAmount,o.destinationToken.decimals))*o.destinationToken.priceUsd*100,slippageBPS:0,feesUSDCents:0,gasCostUSDCents:0,durationSeconds:o.estimatedExecutionTimeMs/1e3},maxSlippageBPS:0},paymentTokens:[{token:{tokenAddress:o.originToken.address,chainId:o.originToken.chainId,decimals:o.originToken.decimals,symbol:o.originToken.symbol,name:o.originToken.name,priceUSDCents:100*o.originToken.priceUsd},amountWei:n.originAmount.toString(),amount:eU.GP(n.originAmount,o.originToken.decimals).toString(),amountUSDCents:Number(eU.GP(n.originAmount,o.originToken.decimals))*o.originToken.priceUsd*100}],processingFees:[{token:{tokenAddress:o.originToken.address,chainId:o.originToken.chainId,decimals:o.originToken.decimals,symbol:o.originToken.symbol,name:o.originToken.name,priceUSDCents:100*o.originToken.priceUsd},amountUSDCents:0,amountWei:"0",amount:"0"}],client:e.client}}catch(e){throw console.error("Error getting buy with crypto quote",e),e}}async function eQ(e){let{id:t,client:n}=e,o=(0,ec.getClientFetch)(n),s=new URL(`${(0,ed.getThirdwebBaseUrl)("bridge")}/v1/onramp/status`);s.searchParams.set("id",t);let i=await o(s.toString());if(!i.ok){let e=await i.json();throw new eu.h({code:e.code||"UNKNOWN_ERROR",message:e.message||i.statusText,correlationId:e.correlationId||void 0,statusCode:i.status})}let{data:a}=await i.json();return a}async function eY(e){let t=await eQ({id:e.intentId,client:e.client});return function(e){let{intentId:t,result:n}=e;var o={intentId:t,status:{CREATED:"PENDING_PAYMENT",PENDING:"PENDING_PAYMENT",FAILED:"PAYMENT_FAILED",COMPLETED:"ON_RAMP_TRANSFER_COMPLETED"}[n.status],purchaseData:n.purchaseData};let{intentId:s,status:i,purchaseData:a}=o,r={chainId:0,tokenAddress:"",decimals:18,priceUSDCents:0,name:"",symbol:""};return{intentId:s,status:i,toAddress:"",fromAddress:"",quote:{estimatedOnRampAmount:"0",estimatedOnRampAmountWei:"0",estimatedToTokenAmount:"0",estimatedToTokenAmountWei:"0",fromCurrency:{amount:"0",amountUnits:"USD",decimals:2,currencySymbol:"USD"},fromCurrencyWithFees:{amount:"0",amountUnits:"USD",decimals:2,currencySymbol:"USD"},onRampToken:r,toToken:r,estimatedDurationSeconds:0,createdAt:new Date().toISOString()},purchaseData:a}}({intentId:e.intentId,result:t})}var eV=n(94),eJ=n(8121);async function eZ(e){let{account:t,transactions:n}=e;if(!t)throw Error("not connected");if(0===n.length)throw Error("No transactions to send");let o=n[0];if(!o)throw Error("No transactions to send");if(t.sendBatchTransaction){let e=await Promise.all(n.map(async e=>{let[t,n,o,s]=await Promise.all([(0,eJ.encode)(e),(0,eV.r)(e.to),(0,eV.r)(e.accessList),(0,eV.r)(e.value)]);return{data:t,chainId:e.chain.id,to:n,value:s,accessList:o}}));return{...await t.sendBatchTransaction(e),chain:o.chain,client:o.client}}throw Error("Account doesn't implement sendBatchTransaction")}var eX=n(23316),e0=n(76016),e1=n(30600);async function e2(e){let{transactionHash:t,client:n}=e,o="chainId"in e?e.chainId:e.chain.id,s=(0,ec.getClientFetch)(n),i=new URL(`${(0,ed.getThirdwebBaseUrl)("bridge")}/v1/status`);i.searchParams.set("transactionHash",t),i.searchParams.set("chainId",o.toString());let a=await s(i.toString());if(!a.ok){let e=await a.json();throw new eu.h({code:e.code||"UNKNOWN_ERROR",message:e.message||a.statusText,correlationId:e.correlationId||void 0,statusCode:a.status})}let{data:r}=await a.json();return"FAILED"===r.status?{status:"FAILED",paymentId:r.paymentId,transactions:r.transactions}:"PENDING"===r.status?{status:"PENDING",originAmount:BigInt(r.originAmount),originChainId:r.originChainId,destinationChainId:r.destinationChainId,originTokenAddress:r.originTokenAddress,destinationTokenAddress:r.destinationTokenAddress,transactions:r.transactions,originToken:r.originToken,destinationToken:r.destinationToken,sender:r.sender,receiver:r.receiver,paymentId:r.paymentId,purchaseData:r.purchaseData}:"NOT_FOUND"===r.status?{status:"NOT_FOUND",paymentId:r.paymentId,transactions:[]}:{status:"COMPLETED",originAmount:BigInt(r.originAmount),destinationAmount:BigInt(r.destinationAmount),originChainId:r.originChainId,destinationChainId:r.destinationChainId,originTokenAddress:r.originTokenAddress,destinationTokenAddress:r.destinationTokenAddress,transactions:r.transactions,originToken:r.originToken,destinationToken:r.destinationToken,sender:r.sender,receiver:r.receiver,paymentId:r.paymentId,purchaseData:r.purchaseData}}async function e5(e){try{if(!e.transactionHash)throw Error("Transaction hash is required");let t=await e2({transactionHash:e.transactionHash,chainId:e.chainId,client:e.client});switch(t.status){case"COMPLETED":{let n=t.transactions?.find(t=>t.chainId===e.chainId),o=t.transactions?.find(t=>t.chainId!==e.chainId);return e8({originTransaction:n,destinationTransaction:o,originAmount:t.originAmount,destinationAmount:t.destinationAmount,originTokenAddress:t.originTokenAddress,destinationTokenAddress:t.destinationTokenAddress,originChainId:t.originChainId,destinationChainId:t.destinationChainId,status:t.status,sender:t.sender,receiver:t.receiver,paymentId:t.paymentId,originToken:t.originToken,destinationToken:t.destinationToken,purchaseData:t.purchaseData})}case"PENDING":return e8({originAmount:t.originAmount,originTokenAddress:t.originTokenAddress,destinationTokenAddress:t.destinationTokenAddress,originChainId:t.originChainId,destinationChainId:t.destinationChainId,status:t.status,sender:t.sender,receiver:t.receiver,paymentId:t.paymentId,originToken:t.originToken,destinationToken:t.destinationToken,purchaseData:t.purchaseData});case"FAILED":{let n=t.transactions?.find(t=>t.chainId===e.chainId),o=t.transactions?.find(t=>t.chainId!==e.chainId);return e8({originTransaction:n,destinationTransaction:o,originAmount:BigInt(0),originTokenAddress:"",destinationTokenAddress:"",originChainId:0,destinationChainId:0,status:t.status,sender:"",receiver:"",paymentId:"",originToken:void 0,destinationToken:void 0,purchaseData:t.purchaseData})}default:return{status:"NOT_FOUND"}}}catch(e){throw console.error("Fetch error:",e),Error(`Fetch failed: ${e}`)}}function e8(e){let{originTransaction:t,destinationTransaction:n,status:o,purchaseData:s,originAmount:i,destinationAmount:a,originTokenAddress:r,destinationTokenAddress:d,originChainId:c,destinationChainId:l,sender:u,receiver:m,originToken:h,destinationToken:p}=e;return{fromAddress:u,toAddress:m,quote:{createdAt:new Date().toISOString(),estimated:{fromAmountUSDCents:0,toAmountMinUSDCents:0,toAmountUSDCents:0,slippageBPS:0,feesUSDCents:0,gasCostUSDCents:0,durationSeconds:0},fromAmount:h?(0,W.toTokens)(i,h.decimals).toString():"",fromAmountWei:i.toString(),toAmount:p&&a?(0,W.toTokens)(a,p.decimals).toString():"",toAmountWei:a?a.toString():"",toAmountMin:p?(0,W.toTokens)(a??BigInt(0),p.decimals).toString():"",toAmountMinWei:a?a.toString():"",fromToken:{tokenAddress:r,chainId:c,decimals:h?.decimals??18,name:h?.name??"",symbol:h?.symbol??"",priceUSDCents:0},toToken:{tokenAddress:d,chainId:l,decimals:p?.decimals??18,name:p?.name??"",symbol:p?.symbol??"",priceUSDCents:0}},swapType:t?.chainId===n?.chainId?"SAME_CHAIN":"CROSS_CHAIN",status:o,subStatus:"COMPLETED"===o?"SUCCESS":"NONE",purchaseData:s,bridge:"STARPORT",destination:{amount:p?(0,W.toTokens)(a??BigInt(0),p.decimals).toString():"",amountWei:a?.toString()??"",token:{tokenAddress:d,chainId:l,decimals:p?.decimals??18,name:p?.name??"",symbol:p?.symbol??"",priceUSDCents:0},amountUSDCents:0,completedAt:new Date().toISOString(),explorerLink:"",transactionHash:n?.transactionHash??""},source:{amount:h?(0,W.toTokens)(i,h.decimals).toString():"",amountWei:i.toString(),token:{tokenAddress:r,chainId:c,decimals:h?.decimals??18,name:h?.name??"",symbol:h?.symbol??"",priceUSDCents:0},amountUSDCents:0,completedAt:new Date().toISOString(),explorerLink:"",transactionHash:t?.transactionHash??""}}}function e3(e){return(0,I.I)({queryKey:["getBuyWithCryptoStatus",e?.transactionHash],queryFn:async()=>{if(!e)throw Error("No params");return e5(e)},enabled:!!e,refetchInterval:e=>{let t=e.state.data?.status;return"COMPLETED"!==t&&"FAILED"!==t&&5e3},refetchIntervalInBackground:!0,retry:!0})}var e4=n(77132);function e6(e){let[t,n]=(0,i.useState)(!1);return(0,o.jsx)(g.$n,{...e,gap:"xs",onClick:async()=>{n(!0);try{await e.switchChain()}catch{}n(!1)},children:t?(0,o.jsxs)(o.Fragment,{children:["Switching",(0,o.jsx)(eD.y,{size:"sm",color:"accentButtonText"})]}):"Switch Network"})}function e9(){let e=(0,B.QP)();return(0,o.jsx)(f.mc,{flex:"row",center:"both",style:{width:"100%",position:"relative",marginTop:"-10px",marginBottom:"-10px",zIndex:1e3},children:(0,o.jsx)(f.mc,{flex:"row",center:"both",style:{borderRadius:"100%",width:"30px",height:"30px",backgroundColor:e.colors.modalBg,border:`1px solid ${e.colors.borderColor}`},children:(0,o.jsx)(eg.D3D,{width:16,height:16})})})}let e7=(0,n(62759).y)([]),te=e=>{let t=e7.getValue();e7.setValue([e,...t])};function tt(e){return(0,o.jsx)(f.mc,{flex:"row",center:"both",color:e.isDone?"success":e.isActive?"accentText":"secondaryText",children:(0,o.jsx)(ti,{children:e.isDone?(0,o.jsx)(eg.Srz,{width:l.RK.sm,height:l.RK.sm}):(0,o.jsx)(ts,{"data-active":e.isActive})})})}function tn(e){return(0,o.jsxs)(f.mc,{flex:"row",center:"y",gap:"xs",style:{fontSize:l.J.sm},color:e.isDone?"success":e.isActive?"accentText":"secondaryText",children:[(0,o.jsx)(tt,{isDone:e.isDone,isActive:e.isActive}),e.label]})}let to=(0,ef.i7)`
0% {
  opacity: 1;
  transform: scale(0.5);
}
100% {
  opacity: 0;
  transform: scale(1.5);
}
`,ts=(0,ew.jx)(()=>({background:"currentColor",width:"10px",height:"10px",borderRadius:"50%",'&[data-active="true"]':{animation:`${to} 1s infinite`}})),ti=(0,ew.jx)(()=>({border:"1px solid currentColor",width:"20px",height:"20px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"}));function ta(e){let t,n="borderColor";return"pending"===e.state?(t="Pending",n="accentText"):"actionRequired"===e.state?n="accentText":"completed"===e.state?(t="Completed",n="success"):"failed"===e.state&&(n="danger",t="Failed"),(0,o.jsxs)(f.mc,{bg:"tertiaryBg",borderColor:"success"===n?"borderColor":n,py:"sm",px:"md",style:{borderRadius:l.r8.lg,alignItems:"flex-start",borderWidth:"1px",borderStyle:"solid",position:"relative",...e.style},children:[e.children,(0,o.jsxs)("div",{style:{position:"absolute",right:l.YK.xs,top:l.YK.xs,display:"flex",gap:l.YK.xs,alignItems:"center"},children:[e.state&&t&&(0,o.jsx)(M.E,{size:"xs",color:n,children:t}),("actionRequired"===e.state||"completed"===e.state)&&(0,o.jsx)(tt,{isActive:"actionRequired"===e.state,isDone:"completed"===e.state}),"pending"===e.state&&(0,o.jsx)(eD.y,{color:"accentText",size:"sm"}),"failed"===e.state&&(0,o.jsx)(f.mc,{color:"danger",flex:"row",center:"both",children:(0,o.jsx)(eg.raE,{width:l.RK.sm,height:l.RK.sm})})]})]})}function tr(e){let t=(0,e4.F)(),n=(0,e1.B)({wallet:e.payer.wallet,connectedWallets:t}),d=function(e){var t;let n=!function(e){let t=e.toToken.chainId===e.onRampToken.token.chainId,n=(0,E.bv)(e.toToken.tokenAddress)===(0,E.bv)(e.onRampToken.token.tokenAddress);return!(t&&n)}(t=e.quote)?[{action:"buy",token:t.toToken,amount:t.estimatedToAmountMin}]:t.routingToken?[{action:"buy",token:t.onRampToken.token,amount:t.onRampToken.amount},{action:"swap",token:t.routingToken.token,amount:t.routingToken.amount},{action:"bridge",token:t.toToken,amount:t.estimatedToAmountMin}]:[{action:"buy",token:t.onRampToken.token,amount:t.onRampToken.amount},{action:"swap",token:t.toToken,amount:t.estimatedToAmountMin}],[o,d]=(0,i.useState)(0),[c,l]=(0,i.useState)(),[u,h]=(0,i.useState)(null),{uiStatus:p}=function(e){var t;let n=(0,s.jE)(),o=(t={intentId:e.intentId,client:e.client,queryOptions:{enabled:!!e.openedWindow}},(0,I.I)({queryKey:["useBuyWithFiatStatus",t],queryFn:async()=>{if(!t)throw Error("No params provided");return eY(t)},enabled:!!t,refetchInterval:e=>{let t=e.state.data,n=t?.status;return"PAYMENT_FAILED"!==n&&("ON_RAMP_TRANSFER_COMPLETED"!==n||t?.quote.toToken.chainId!==t?.quote.onRampToken.chainId||t?.quote.toToken.tokenAddress.toLowerCase()!==t?.quote.onRampToken.tokenAddress.toLowerCase())&&5e3},refetchIntervalInBackground:!0,retry:!0,...t?.queryOptions})),a="actionRequired";switch(o.data?.status){case"ON_RAMP_TRANSFER_COMPLETED":a="completed";break;case"PAYMENT_FAILED":a="failed";break;case"PENDING_PAYMENT":a="pending";break;default:a="actionRequired"}let r=(0,i.useRef)(!1);(0,i.useEffect)(()=>{!r.current&&e.onSuccess&&o.data&&"completed"===a&&(r.current=!0,e.onSuccess(o.data))},[e.onSuccess,o.data,a]),(0,i.useEffect)(()=>{if(e.openedWindow&&"completed"===a)try{e.openedWindow&&!e.openedWindow.closed&&e.openedWindow.close()}catch(e){console.warn("Failed to close payment window:",e)}},[e.openedWindow,a]);let d=(0,i.useRef)(!1);return(0,i.useEffect)(()=>{d.current||"completed"!==a||(d.current=!0,(0,m.V)(n))},[a,n]),{uiStatus:a}}({intentId:e.quote.intentId,client:e.client,onSuccess:t=>{1===n.length?e.onSuccess(t):d(e=>e+1)},openedWindow:u}),x=n[o-1],y=n[o],f=function(e){let t=(0,s.jE)();return(0,eM.n)({mutationFn:async t=>{let n,{fromToken:o,toToken:s,amount:i}=t,d=e.payer.wallet;d.getChain()?.id!==o.chainId&&await d.switchChain((0,r.Q4)(o.chainId));let c=d.getAccount();if(!c)throw Error("Payer wallet has no account");let l=await eH({fromChainId:o.chainId,fromTokenAddress:o.tokenAddress,toAmount:i,toChainId:s.chainId,toTokenAddress:s.tokenAddress,fromAddress:c.address,toAddress:c.address,paymentLinkId:e.paymentLinkId,client:e.client}),u=c.sendBatchTransaction,m=(0,S.P)({client:e.client,address:l.swapDetails.fromToken.tokenAddress,chain:(0,r.Q4)(l.swapDetails.fromToken.chainId)}),h=l.approvalData&&await (0,eO.nB)({contract:m,owner:c.address,spender:l.approvalData.spenderAddress})<BigInt(l.approvalData.amountWei);if(h&&l.approvalData&&!u){(0,a.G)({event:"prompt_swap_approval",client:e.client,walletAddress:c.address,walletType:e.payer.wallet.id,fromToken:l.swapDetails.fromToken.tokenAddress,chainId:l.swapDetails.fromToken.chainId,amountWei:l.swapDetails.fromAmountWei,toToken:l.swapDetails.toToken.tokenAddress,toChainId:l.swapDetails.toToken.chainId});let t=(0,e_.S)({contract:m,spender:l.approvalData.spenderAddress,amountWei:BigInt(l.approvalData.amountWei)}),n=await (0,eX.sendTransaction)({account:c,transaction:t});await (0,e0.L)({...n,maxBlocksWaitTime:50}),(0,a.G)({event:"swap_approval_success",client:e.client,walletAddress:c.address,walletType:e.payer.wallet.id,fromToken:l.swapDetails.fromToken.tokenAddress,amountWei:l.swapDetails.fromAmountWei,toToken:l.swapDetails.toToken.tokenAddress,chainId:l.swapDetails.fromToken.chainId,toChainId:l.swapDetails.toToken.chainId})}(0,a.G)({event:"prompt_swap_execution",client:e.client,walletAddress:c.address,walletType:e.payer.wallet.id,fromToken:l.swapDetails.fromToken.tokenAddress,amountWei:l.swapDetails.fromAmountWei,toToken:l.swapDetails.toToken.tokenAddress,chainId:l.swapDetails.fromToken.chainId,toChainId:l.swapDetails.toToken.chainId});let p=l.transactionRequest;if(u&&l.approvalData&&h){let e=(0,e_.S)({contract:m,spender:l.approvalData.spenderAddress,amountWei:BigInt(l.approvalData.amountWei)});n=await eZ({account:c,transactions:[e,p]})}else n=await (0,eX.sendTransaction)({account:c,transaction:p});return await (0,e0.L)({...n,maxBlocksWaitTime:50}),(0,a.G)({event:"swap_execution_success",client:e.client,walletAddress:c.address,walletType:e.payer.wallet.id,fromToken:l.swapDetails.fromToken.tokenAddress,amountWei:l.swapDetails.fromAmountWei,toToken:l.swapDetails.toToken.tokenAddress,toChainId:l.swapDetails.toToken.chainId,chainId:l.swapDetails.fromToken.chainId}),e.isFiatFlow||te({type:"swap",txHash:n.transactionHash,chainId:n.chain.id}),{transactionHash:n.transactionHash,chainId:n.chain.id}},onSuccess:()=>{(0,m.V)(t)}})}({client:e.client,payer:e.payer,isFiatFlow:!0,paymentLinkId:e.paymentLinkId}),{uiStatus:g}=function(e){let t=e3(e.transactionHash&&e.chainId?{client:e.client,transactionHash:e.transactionHash,chainId:e.chainId}:void 0),n="unknown";switch(t.data?.status){case"COMPLETED":n="completed";break;case"FAILED":n="failed";break;case"PENDING":case"NOT_FOUND":n="pending";break;default:n="unknown"}let o=(0,i.useRef)(!1);(0,i.useEffect)(()=>{!o.current&&e.onSuccess&&t.data?.status==="COMPLETED"&&(o.current=!0,e.onSuccess(t.data))},[e.onSuccess,t]);let a=(0,s.jE)(),r=(0,i.useRef)(!1);return(0,i.useEffect)(()=>{"completed"!==n||r.current||(r.current=!0,(0,m.V)(a))},[a,n]),{uiStatus:n}}({client:e.client,transactionHash:c?.hash,chainId:c?.chainId,onSuccess:()=>{o===n.length-1?eY({intentId:e.quote.intentId,client:e.client}).then(e.onSuccess):(l(void 0),f.reset(),d(e=>e+1))}}),k=n.map((e,t)=>{let n="unknown";return 0===t?n=p:t<o?n="completed":t===o&&(n=f.isPending?"pending":f.error?"failed":c?g:"actionRequired"),{index:t,step:e,status:n}}),w=k.some(e=>"pending"===e.status),j=k.every(e=>"completed"===e.status),T=k.some(e=>"failed"===e.status),b=(0,i.useCallback)(async()=>{if(j)return void e.onDone();if(0===o){let t=function(e,t){let n=(window.innerHeight-750)/2,o=(window.innerWidth-500)/2;return window.open(`${e}&theme=${t}`,"thirdweb Pay",`width=500, height=750, top=${n}, left=${o}`)}(e.quote.onRampLink,e.theme);(0,a.G)({event:"open_onramp_popup",client:e.client,walletAddress:e.payer.account.address,walletType:e.payer.wallet.id,toChainId:e.quote.onRampToken.token.chainId,toToken:e.quote.onRampToken.token.tokenAddress,amountWei:e.quote.onRampToken.amountWei}),h(t),te({type:"fiat",intentId:e.quote.intentId})}else if(x&&y&&!c)try{let e=await f.mutateAsync({fromToken:x.token,toToken:y.token,amount:y.amount});l({hash:e.transactionHash,chainId:e.chainId})}catch(e){console.error("Failed to execute swap:",e)}else T&&(l(void 0),f.reset())},[j,o,c,e.quote,e.onDone,f,e.theme,T,f.reset,e.client,e.payer.account.address,e.payer.wallet.id,y,x]);return(0,i.useEffect)(()=>{e.isAutoMode&&(w||j||T||!(o>0)||!(o<n.length)||c||b())},[e.isAutoMode,o,c,n.length,b,j,T,w]),{steps:k,handleContinue:b,isLoading:w,isDone:j,isFailed:T}}({quote:e.quote,client:e.client,onSuccess:e.onSuccess,onDone:e.onDone,payer:e.payer,theme:e.theme,isAutoMode:n,paymentLinkId:e.paymentLinkId}),c=d.steps[0]?.step.token.chainId;return(0,o.jsxs)(f.mc,{p:"lg",children:[(0,o.jsx)(f.rQ,{title:e.title,onBack:e.onBack}),(0,o.jsx)(y.h,{y:"xl"}),(0,o.jsx)(f.mc,{flex:"column",gap:"xs",center:"y",style:{paddingLeft:l.YK.md},children:(0,o.jsx)(X.k,{client:e.client,address:e.receiverAddress,iconSize:"md",textSize:"sm",label:"Recipient wallet"})}),(0,o.jsx)(y.h,{y:"md"}),(0,o.jsx)(f.mc,{flex:"column",children:d.steps.map(({step:t,status:n},s)=>(0,o.jsxs)(f.mc,{flex:"column",children:[(0,o.jsx)(ta,{state:n,index:s,style:{flex:"1"},children:(0,o.jsx)(td,{step:t,client:e.client,payer:e.payer,index:s})}),s<d.steps.length-1&&(0,o.jsx)(e9,{})]},t.action))}),(0,o.jsx)(y.h,{y:"md"}),(0,o.jsx)(M.E,{size:"xs",color:"secondaryText",center:!0,style:{padding:`0 ${l.YK.xl}`},children:"Keep this window open until all transactions are complete."}),(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsx)(f.mc,{flex:"column",gap:"md",children:!d.isDone&&c&&c!==e.payer.chain.id?(0,o.jsx)(e6,{fullWidth:!0,variant:"accent",switchChain:async()=>{await e.payer.wallet.switchChain((0,r.Q4)(c))}}):(0,o.jsxs)(g.$n,{variant:"accent",gap:"sm",fullWidth:!0,onClick:d.handleContinue,disabled:d.isLoading,children:[d.isLoading?"Processing":d.isDone?e.transactionMode?"Continue Transaction":"Done":d.isFailed?"Retry":"Continue",d.isLoading&&(0,o.jsx)(eD.y,{size:"sm",color:"primaryText"})]})})]})}function td(e){let{step:t,client:n}=e,s=(0,R.Kj)((0,r.Q4)(t.token.chainId));return(0,o.jsx)(f.mc,{flex:"column",gap:"xs",py:"3xs",children:(0,o.jsxs)(f.mc,{flex:"row",center:"y",gap:"sm",style:{display:"flex",justifyContent:"space-between",flexWrap:"nowrap"},children:[(0,o.jsx)(H,{chain:(0,r.Q4)(t.token.chainId),client:n,size:"md",token:{address:t.token.tokenAddress}}),(0,o.jsxs)(f.mc,{flex:"column",gap:"3xs",center:"y",style:{flex:"1"},children:[(0,o.jsx)(M.E,{size:"sm",color:"primaryText",children:eB(t.action)}),(0,o.jsxs)(f.mc,{flex:"row",gap:"xs",center:"y",style:{display:"flex",justifyContent:"space-between",flexWrap:"nowrap"},children:[(0,o.jsxs)(f.mc,{flex:"row",gap:"xxs",center:"y",style:{flex:"1 1 60%",minWidth:0,maxWidth:"60%",overflow:"hidden",flexWrap:"nowrap"},children:[(0,o.jsx)(M.E,{size:"sm",color:"primaryText",children:(0,c.Z)(Number(t.amount),5)}),(0,o.jsx)(w.C,{token:{address:t.token.tokenAddress,name:t.token.name||"",symbol:t.token.symbol||""},chain:(0,r.Q4)(t.token.chainId),size:"sm",color:"secondaryText"})]}),(0,o.jsx)(f.mc,{flex:"row",gap:"xs",center:"y",style:{flex:"1 1 40%",maxWidth:"40%",minWidth:0,justifyContent:"flex-end",flexWrap:"nowrap"},children:(0,o.jsx)(M.E,{size:"xs",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s.name})})]})]})]})})}let tc=(0,r.xH)({id:137,name:"Polygon",nativeCurrency:{name:"POL",symbol:"POL",decimals:18},blockExplorers:[{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.polygonscan.com/api"}]});var tl=n(57693),tu=n(51298);function tm(e){let{name:t}=(0,R.Kj)(e.chain);return e.token&&e.chain?(0,o.jsxs)(th,{variant:"secondary",fullWidth:!0,style:{fontSize:l.J.sm,...e.style},gap:"xxs",onClick:e.onSelectToken,disabled:e.freezeChainAndToken,children:[(0,o.jsxs)(f.mc,{flex:"row",center:"y",gap:"sm",children:[(0,o.jsx)(H,{token:e.token,chain:e.chain,size:"md",client:e.client}),(0,o.jsxs)(f.mc,{flex:"column",gap:"4xs",children:[(0,o.jsx)(f.mc,{flex:"column",gap:"4xs",children:e.isLoading?(0,o.jsx)(Y.E,{width:"120px",height:l.J.md,color:"borderColor"}):e.value?(0,o.jsxs)(f.mc,{flex:"row",gap:"xxs",center:"y",color:"primaryText",children:[(0,o.jsx)(M.E,{size:"md",color:e.value?"primaryText":"secondaryText",children:(0,c.Z)(Number(e.value),6)||""}),(0,o.jsx)(w.C,{token:e.token,chain:e.chain,color:"secondaryText",size:"sm"})]}):(0,o.jsx)(w.C,{token:e.token,chain:e.chain,size:"sm"})}),t?(0,o.jsx)(M.E,{size:"xs",color:"secondaryText",children:t}):(0,o.jsx)(Y.E,{width:"90px",height:l.J.xs})]})]}),!e.freezeChainAndToken&&(0,o.jsx)(f.mc,{color:"primaryText",children:(0,o.jsx)(eg.D3D,{width:l.RK.sm,height:l.RK.sm})})]}):(0,o.jsxs)(g.$n,{variant:"secondary",fullWidth:!0,style:{fontSize:l.J.sm,justifyContent:"space-between",paddingTop:l.YK.md,paddingBottom:l.YK.md,...e.style},gap:"xxs",onClick:e.onSelectToken,children:[(0,o.jsx)(M.E,{size:"sm",color:"primaryText",children:"Select payment token"}),(0,o.jsx)(f.mc,{color:"primaryText",children:(0,o.jsx)(eg.D3D,{width:l.RK.sm,height:l.RK.sm})})]})}let th=(0,et.A)(g.$n)(()=>{let e=(0,B.QP)();return{background:e.colors.tertiaryBg,border:`1px solid ${e.colors.borderColor}`,justifyContent:"space-between",transition:"background 0.3s",padding:l.YK.sm}});var tp=n(27904);function tx(e){let t=(0,tu.o)(e.tokenAmount,500),n=(0,I.I)({queryKey:["cryptoToFiat",e.chain.id,(0,v.me)(e.token),t],queryFn:()=>(0,tp.c)({client:e.client,chain:e.chain,fromTokenAddress:(0,v.me)(e.token),fromAmount:Number(t),to:"USD"})});return n.isLoading?(0,o.jsx)(Y.E,{width:"50px",height:l.J.lg}):n.data?.result?(0,o.jsxs)(M.E,{...e,children:["$",(0,c.Z)(n.data.result,2).toFixed(2)]}):null}function ty(e){var t;let n;return(0,o.jsxs)(f.mc,{children:[(0,o.jsx)("div",{onClick:e=>{e.currentTarget.querySelector("input")?.focus()},children:(0,o.jsxs)(f.mc,{flex:"row",center:"both",gap:"xs",style:{flexWrap:"nowrap"},children:[(0,o.jsx)(k.pd,{variant:"outline",pattern:"^[0-9]*[.,]?[0-9]*$",inputMode:"decimal",tabIndex:-1,placeholder:"0",type:"text","data-placeholder":""===e.value,value:e.value||"0",disabled:e.freezeAmount,onClick:t=>{""===e.value&&t.currentTarget.setSelectionRange(t.currentTarget.value.length,t.currentTarget.value.length)},onChange:t=>{let n=t.target.value;(n=n.replace(",",".")).startsWith(".")&&(n=`0${n}`),Number.isNaN(Number(n))||(n.startsWith("0")&&!n.startsWith("0.")?e.onChange(n.slice(1)):e.onChange(n))},style:{border:"none",fontSize:(t=e.value).length>10?"26px":t.length>6?"34px":"50px",boxShadow:"none",borderRadius:"0",padding:"0",paddingBlock:"2px",fontWeight:600,textAlign:"right",width:(n=e.value.replace(".","").length,e.value.includes(".")&&(n+=.3),`calc(${Math.max(1,n)}ch + 6px)`),maxWidth:"calc(100% - 100px)"}}),(0,o.jsx)(w.C,{token:e.token,chain:e.chain,size:"lg",color:"secondaryText"})]})}),(0,o.jsx)(f.mc,{flex:"row",center:"both",style:{height:l.J.xl},children:(0,o.jsx)(tx,{tokenAmount:e.value,token:e.token,chain:e.chain,client:e.client,size:"md"})}),!e.hideTokenSelector&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.h,{y:"md"}),(0,o.jsx)(f.mc,{flex:"row",center:"x",children:(0,o.jsx)(tm,{token:e.token,chain:e.chain,client:e.client,onSelectToken:e.onSelectToken,freezeChainAndToken:e.freezeChainAndToken})})]})]})}function tf(e){return(0,o.jsx)(f.mc,{bg:"tertiaryBg",flex:"row",style:{height:"8px",borderRadius:l.r8.lg},children:(0,o.jsx)(f.mc,{bg:"accentText",style:{width:`${e.currentStep/e.steps*95}%`,borderRadius:l.r8.lg},children:null})})}function tg(e){return(0,o.jsxs)(f.mc,{gap:"xxs",flex:"column",children:[(0,o.jsxs)(f.mc,{flex:"row",gap:"xxs",center:"both",color:"danger",children:[(0,o.jsx)(eg._cW,{width:l.RK.sm,height:l.RK.sm}),(0,o.jsx)(M.E,{color:"danger",size:"sm",children:e.title})]}),(0,o.jsx)(M.E,{center:!0,size:"xs",children:e.message})]})}function tk(e){let t=(0,B.QP)(),n=e.receiver.toLowerCase()!==e.sender.toLowerCase();return(0,o.jsxs)(f.mc,{children:[(0,o.jsxs)(f.mc,{bg:"tertiaryBg",flex:"column",style:{borderRadius:l.r8.lg,border:`1px solid ${t.colors.borderColor}`},children:[(0,o.jsx)(f.mc,{flex:"row",gap:"sm",p:"sm",style:{borderBottom:`1px solid ${t.colors.borderColor}`},children:(0,o.jsx)(X.k,{address:e.sender,client:e.client,iconSize:"md",textSize:"sm"})}),(0,o.jsx)(tm,{token:e.fromToken,chain:e.fromChain,client:e.client,isLoading:!1,value:e.fromAmount,freezeChainAndToken:!0,onSelectToken:()=>{},style:{background:"transparent",borderRadius:0,border:"none"}})]}),(0,o.jsx)(e9,{}),(0,o.jsxs)(f.mc,{flex:"column",bg:"tertiaryBg",style:{borderRadius:l.r8.lg,border:`1px solid ${t.colors.borderColor}`},children:[n&&(0,o.jsx)(f.mc,{flex:"row",gap:"sm",p:"sm",style:{borderBottom:`1px solid ${t.colors.borderColor}`},children:(0,o.jsx)(X.k,{address:e.receiver,client:e.client,iconSize:"md",textSize:"sm"})}),(0,o.jsx)(tm,{token:e.toToken,chain:e.toChain,client:e.client,isLoading:!1,value:e.toAmount,freezeChainAndToken:!0,onSelectToken:()=>{},style:{background:"transparent",borderRadius:0,border:"none"}})]})]})}function tw(e){let t=e.quote.approvalData&&void 0!==e.preApprovedAmount&&e.preApprovedAmount<BigInt(e.quote.approvalData.amountWei),n=t&&!e.payer.account.sendBatchTransaction,[s,r]=(0,i.useState)(n?"approval":"swap"),[d,c]=(0,i.useState)(),[l,u]=(0,i.useState)("idle"),m=e.quote.swapDetails.toAddress,h=e.quote.swapDetails.fromAddress,p=(0,i.useMemo)(()=>"approval"===s&&"error"===l&&d?d.toLowerCase().includes("user rejected")||d.toLowerCase().includes("user closed modal")||d.toLowerCase().includes("user denied")?{title:"Failed to Approve",message:"Your wallet rejected the approval request."}:{title:"Failed to Approve",message:"Your wallet failed to approve the transaction for an unknown reason. Please try again or contact support."}:"swap"===s&&"error"===l&&d?d.toLowerCase().includes("user rejected")||d.toLowerCase().includes("user closed modal")||d.toLowerCase().includes("user denied")?{title:"Failed to Confirm",message:"Your wallet rejected the confirmation request."}:{title:"Failed to Confirm",message:"Your wallet failed to confirm the transaction for an unknown reason. Please try again or contact support."}:void 0,[d,s,l]);return(0,o.jsxs)(f.mc,{p:"lg",children:[(0,o.jsx)(f.rQ,{title:e.title,onBack:e.onBack}),e.isFiatFlow?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsx)(tf,{steps:2,currentStep:2}),(0,o.jsx)(y.h,{y:"sm"}),(0,o.jsxs)(M.E,{size:"xs",children:["Step 2 of 2 - Converting ",e.fromTokenSymbol," to"," ",e.toTokenSymbol]}),(0,o.jsx)(y.h,{y:"md"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsx)(M.E,{size:"sm",children:"Confirm payment"}),(0,o.jsx)(y.h,{y:"md"})]}),(0,o.jsx)(tk,{sender:h,receiver:m,client:e.client,fromToken:e.fromToken,fromChain:e.fromChain,toToken:e.toToken,toChain:e.toChain,fromAmount:e.fromAmount,toAmount:e.toAmount}),(0,o.jsx)(y.h,{y:"md"}),n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.h,{y:"sm"}),(0,o.jsxs)(f.mc,{gap:"sm",flex:"row",style:{justifyContent:"space-between"},center:"y",color:"accentText",children:[(0,o.jsx)(tn,{isDone:"swap"===s,isActive:"approval"===s,label:"approval"===s?"Approve":"Approved"}),(0,o.jsx)(tj,{}),(0,o.jsx)(tn,{isDone:!1,label:"Confirm",isActive:"swap"===s})]}),(0,o.jsx)(y.h,{y:"lg"})]}),p&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tg,{title:p.title,message:p.message}),(0,o.jsx)(y.h,{y:"md"})]}),e.payer.chain.id!==e.fromChain.id?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.h,{y:"xs"}),(0,o.jsx)(e6,{fullWidth:!0,variant:"accent",switchChain:async()=>{await e.payer.wallet.switchChain(e.fromChain)}})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.h,{y:"xs"}),(0,o.jsxs)(g.$n,{variant:"accent",fullWidth:!0,disabled:"pending"===l,onClick:async()=>{let n=e.payer.wallet;n.getChain()?.id!==e.fromChain.id&&await n.switchChain(e.fromChain);let o=n.getAccount();if(!o)throw Error("Payer wallet has no account");if("approval"===s&&e.quote.approvalData)try{u("pending"),(0,a.G)({event:"prompt_swap_approval",client:e.client,walletAddress:o.address,walletType:n.id,fromToken:e.quote.swapDetails.fromToken.tokenAddress,amountWei:e.quote.swapDetails.fromAmountWei,toToken:e.quote.swapDetails.toToken.tokenAddress,toChainId:e.quote.swapDetails.toToken.chainId,chainId:e.quote.swapDetails.fromToken.chainId});let t=(0,e_.S)({contract:(0,S.P)({client:e.client,address:e.quote.swapDetails.fromToken.tokenAddress,chain:e.fromChain}),spender:e.quote.approvalData.spenderAddress,amountWei:BigInt(e.quote.approvalData.amountWei)}),s=await (0,eX.sendTransaction)({account:o,transaction:t});await (0,e0.L)({...s,maxBlocksWaitTime:50}),(0,a.G)({event:"swap_approval_success",client:e.client,walletAddress:o.address,walletType:n.id,fromToken:e.quote.swapDetails.fromToken.tokenAddress,amountWei:e.quote.swapDetails.fromAmountWei,toToken:e.quote.swapDetails.toToken.tokenAddress,toChainId:e.quote.swapDetails.toToken.chainId,chainId:e.quote.swapDetails.fromToken.chainId}),r("swap"),u("idle")}catch(e){console.error(e),c(e.message),u("error")}if("swap"===s){u("pending");try{let s;(0,a.G)({event:"prompt_swap_execution",client:e.client,walletAddress:o.address,walletType:n.id,fromToken:e.quote.swapDetails.fromToken.tokenAddress,amountWei:e.quote.swapDetails.fromAmountWei,toToken:e.quote.swapDetails.toToken.tokenAddress,toChainId:e.quote.swapDetails.toToken.chainId,chainId:e.quote.swapDetails.fromToken.chainId});let i=e.quote.transactionRequest;if(o.sendBatchTransaction&&e.quote.approvalData&&t){let t=(0,e_.S)({contract:(0,S.P)({client:e.client,address:e.quote.swapDetails.fromToken.tokenAddress,chain:e.fromChain}),spender:e.quote.approvalData.spenderAddress,amountWei:BigInt(e.quote.approvalData.amountWei)});s=await eZ({account:o,transactions:[t,i]})}else s=await (0,eX.sendTransaction)({account:o,transaction:i});(0,a.G)({event:"swap_execution_success",client:e.client,walletAddress:o.address,walletType:n.id,fromToken:e.quote.swapDetails.fromToken.tokenAddress,amountWei:e.quote.swapDetails.fromAmountWei,toToken:e.quote.swapDetails.toToken.tokenAddress,toChainId:e.quote.swapDetails.toToken.chainId,chainId:e.quote.swapDetails.fromToken.chainId}),e.isFiatFlow||te({type:"swap",txHash:s.transactionHash,chainId:s.chain.id}),e.setSwapTxHash(s.transactionHash)}catch(e){console.error(e),u("error")}}},gap:"xs",children:["approval"===s&&("pending"===l?"Approving":"Approve"),"swap"===s&&("pending"===l?"Confirming":"Confirm"),"pending"===l&&(0,o.jsx)(eD.y,{size:"sm",color:"accentButtonText"})]})]})]})}let tj=(0,ew.jx)(()=>({height:"4px",background:(0,B.QP)().colors.borderColor,flex:1}));var tT=n(55340),tb=n(58669);function tA(e){let t=(0,i.useMemo)(()=>(0,r.Q4)(e.chainId),[e.chainId]),{name:n}=(0,R.Kj)(t);return(0,o.jsxs)(f.mc,{flex:"row",style:{justifyContent:"space-between"},children:[(0,o.jsx)(M.E,{size:"sm",children:e.label}),(0,o.jsxs)(f.mc,{flex:"column",gap:"3xs",style:{alignItems:"flex-end"},children:[(0,o.jsxs)(f.mc,{flex:"row",gap:"xs",center:"y",children:[(0,o.jsx)(H,{chain:t,size:"sm",token:{address:e.tokenAddress},client:e.client}),(0,o.jsxs)(M.E,{color:"primaryText",size:"sm",children:[(0,c.Z)(Number(e.tokenAmount),6)," ",e.tokenSymbol]})]}),(0,o.jsx)(M.E,{size:"xs",children:n})]})]})}function tC(e){let t,n=!0;if("status"===e.type){let o=e.status;e.hideStatusRow&&(n=!1);let s="COMPLETED"===o.status&&"PARTIAL_SUCCESS"===o.subStatus;t={fromToken:{chainId:o.quote.fromToken.chainId,symbol:o.quote.fromToken.symbol||"",address:o.quote.fromToken.tokenAddress,amount:o.quote.fromAmount},quotedToToken:{chainId:o.quote.toToken.chainId,symbol:o.quote.toToken.symbol||"",address:o.quote.toToken.tokenAddress,amount:o.quote.toAmount},gotToken:o.destination?{chainId:o.destination.token.chainId,symbol:o.destination.token.symbol||"",address:o.destination.token.tokenAddress,amount:o.destination.amount}:void 0,statusMeta:function(e){if("NOT_FOUND"===e.status)return{status:"Unknown",color:"secondaryText"};let t=e.subStatus,n=e.status;return"WAITING_BRIDGE"===t?{status:"Bridging",color:"accentText",loading:!0}:"PARTIAL_SUCCESS"===t?{status:"Incomplete",color:"secondaryText"}:"PENDING"===n?{status:"Pending",color:"accentText",loading:!0}:"FAILED"===n?{status:"Failed",color:"danger"}:"COMPLETED"===n?{status:"Completed",color:"success"}:{status:"Unknown",color:"secondaryText"}}(o),estimatedDuration:o.quote.estimated.durationSeconds||0,isPartialSuccess:s,destinationTxHash:o.destination?.transactionHash,sourceTxHash:o.source?.transactionHash,fromAddress:o.fromAddress,toAddress:o.toAddress}}else{let n=e.quote;t={fromToken:{chainId:n.swapDetails.fromToken.chainId,symbol:n.swapDetails.fromToken.symbol||"",address:n.swapDetails.fromToken.tokenAddress,amount:n.swapDetails.fromAmount},quotedToToken:{chainId:n.swapDetails.toToken.chainId,symbol:n.swapDetails.toToken.symbol||"",address:n.swapDetails.toToken.tokenAddress,amount:n.swapDetails.toAmount},isPartialSuccess:!1,estimatedDuration:n.swapDetails.estimated.durationSeconds||0,fromAddress:n.swapDetails.fromAddress,toAddress:n.swapDetails.toAddress}}let{client:s}=e,{fromToken:i,quotedToToken:a,statusMeta:d,sourceTxHash:c,destinationTxHash:u,isPartialSuccess:m,gotToken:h}=t,p=i.chainId,x=a.chainId,k=(0,R.Kj)((0,r.Q4)(p)),w=(0,R.Pi)((0,r.Q4)(p)),j=(0,R.Kj)((0,r.Q4)(x)),T=(0,R.Pi)((0,r.Q4)(x)),b=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.h,{y:"md"}),(0,o.jsx)(f.N1,{}),(0,o.jsx)(y.h,{y:"md"})]});return(0,o.jsxs)("div",{children:[(0,o.jsx)(tA,{chainId:i.chainId,client:s,label:"Paid",tokenAmount:i.amount,tokenSymbol:i.symbol||"",tokenAddress:i.address}),b,m&&h?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tA,{chainId:a.chainId,client:s,label:m?"Expected":"Received",tokenAmount:a.amount,tokenSymbol:a.symbol||"",tokenAddress:a.address}),b,(0,o.jsx)(tA,{chainId:h.chainId,client:s,label:"Got",tokenAmount:h.amount,tokenSymbol:h.symbol||"",tokenAddress:h.address})]}):(0,o.jsx)(tA,{chainId:a.chainId,client:s,label:"Received",tokenAmount:a.amount,tokenSymbol:a.symbol||"",tokenAddress:a.address}),(0,o.jsxs)(o.Fragment,{children:[b,(0,o.jsxs)(f.mc,{flex:"row",style:{justifyContent:"space-between"},children:[(0,o.jsx)(M.E,{size:"sm",children:"Recipient"}),(0,o.jsx)(X.k,{address:t.toAddress,iconSize:"sm",client:s})]})]}),d&&n&&(0,o.jsxs)(o.Fragment,{children:[b,(0,o.jsxs)(f.mc,{flex:"row",style:{justifyContent:"space-between"},children:[(0,o.jsx)(M.E,{size:"sm",children:"Status"}),(0,o.jsx)(f.mc,{flex:"column",gap:"3xs",center:"y",style:{alignItems:"flex-end"},children:(0,o.jsx)(M.E,{color:d.color,size:"sm",children:d.status})})]})]}),(0,o.jsx)(y.h,{y:"lg"}),w.explorers?.[0]?.url&&c&&(0,o.jsxs)(g.vx,{fullWidth:!0,variant:"outline",href:(0,tb.MS)(w.explorers[0]?.url,c),target:"_blank",gap:"xs",style:{fontSize:l.J.sm,padding:l.YK.sm},children:["View on ",k.name," Explorer",(0,o.jsx)(eg.pTT,{width:l.RK.sm,height:l.RK.sm})]}),u&&c!==u&&T?.explorers?.[0]?.url&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.h,{y:"sm"}),(0,o.jsxs)(g.vx,{fullWidth:!0,variant:"outline",href:(0,tb.MS)(T.explorers[0]?.url,u),target:"_blank",gap:"xs",style:{fontSize:l.J.sm,padding:l.YK.sm},children:["View on ",j.name," Explorer",(0,o.jsx)(eg.pTT,{width:l.RK.sm,height:l.RK.sm})]})]})]})}function tv(e){let{onSuccess:t}=e,[n,a]=(0,i.useState)(!1),r=e3({client:e.client,transactionHash:e.swapTxHash,chainId:e.fromChain.id}),d="pending";r.data?.status==="COMPLETED"?d="success":r.data?.status==="FAILED"&&(d="failed"),r.data?.status==="COMPLETED"&&r.data?.subStatus==="PARTIAL_SUCCESS"&&(d="partialSuccess");let c=(0,i.useRef)(!1);(0,i.useEffect)(()=>{!c.current&&t&&r.data?.status==="COMPLETED"&&(c.current=!0,t(r.data))},[t,r]);let u=(0,s.jE)(),h=(0,i.useRef)(!1);(0,i.useEffect)(()=>{"success"!==d&&"partialSuccess"!==d||h.current||(h.current=!0,(0,m.V)(u))},[u,d]);let p=r.data&&"NOT_FOUND"!==r.data.status?(0,o.jsx)(tC,{status:r.data,type:"status",client:e.client}):e.quote?(0,o.jsx)(tC,{type:"quote",quote:e.quote,client:e.client}):null;return n?(0,o.jsx)(f.mc,{animate:"fadein",children:(0,o.jsxs)(f.mc,{p:"lg",children:[(0,o.jsx)(f.rQ,{title:"Transaction Details",onBack:()=>a(!1)}),(0,o.jsx)(y.h,{y:"xl"}),p]})}):(0,o.jsx)(f.mc,{animate:"fadein",children:(0,o.jsxs)(f.mc,{p:"lg",children:[(0,o.jsx)(f.rQ,{title:e.title,onBack:e.onBack}),(0,o.jsx)(y.h,{y:"sm"}),"success"===d&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.h,{y:"md"}),(0,o.jsxs)(f.mc,{color:"success",flex:"column",center:"x",children:[(0,o.jsx)(eg.KaV,{width:l.RK["3xl"],height:l.RK["3xl"]}),(0,o.jsx)(y.h,{y:"sm"}),(0,o.jsx)(M.E,{color:"primaryText",size:"lg",children:"Buy Complete"})]}),(0,o.jsx)(y.h,{y:"xl"}),(0,o.jsx)(g.$n,{variant:"outline",fullWidth:!0,onClick:()=>a(!0),children:"View transaction details"}),(0,o.jsx)(y.h,{y:"sm"}),(0,o.jsx)(g.$n,{variant:"accent",fullWidth:!0,onClick:e.onDone,children:e.transactionMode?"Continue Transaction":"Done"})]}),"partialSuccess"===d&&r.data?.status!=="NOT_FOUND"&&r.data?.destination&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsxs)(f.mc,{color:"success",flex:"column",center:"x",children:[(0,o.jsx)(tT.g,{size:l.RK["3xl"]}),(0,o.jsx)(y.h,{y:"xl"}),(0,o.jsx)(M.E,{color:"primaryText",size:"lg",children:"Incomplete"}),(0,o.jsx)(y.h,{y:"sm"}),(0,o.jsxs)(M.E,{size:"sm",color:"danger",children:["Expected ",r.data.quote.toToken.symbol,", Got"," ",r.data.destination.token.symbol," instead"]})]}),(0,o.jsx)(y.h,{y:"xl"})]}),"failed"===d&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.h,{y:"xxl"}),(0,o.jsxs)(f.mc,{flex:"column",children:[(0,o.jsxs)(f.mc,{flex:"column",center:"both",children:[(0,o.jsx)(tT.g,{size:l.RK["3xl"]}),(0,o.jsx)(y.h,{y:"xl"}),(0,o.jsx)(M.E,{color:"primaryText",size:"lg",children:"Transaction Failed"}),(0,o.jsx)(y.h,{y:"sm"}),(0,o.jsxs)(M.E,{size:"sm",children:["Your transaction ","couldn't"," be processed"]})]}),(0,o.jsx)(y.h,{y:"xl"}),(0,o.jsx)(g.$n,{variant:"outline",fullWidth:!0,onClick:()=>a(!0),children:"View transaction details"}),(0,o.jsx)(y.h,{y:"sm"}),(0,o.jsx)(g.$n,{variant:"accent",fullWidth:!0,onClick:e.onTryAgain,children:"Try Again"})]})]}),"pending"===d&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.h,{y:"xl"}),(0,o.jsxs)(f.mc,{flex:"column",animate:"fadein",center:"both",children:[(0,o.jsx)("div",{style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,o.jsx)(eD.y,{size:"3xl",color:"accentText"})}),(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsx)(M.E,{color:"primaryText",size:"lg",children:"Buy Pending"}),(0,o.jsx)(y.h,{y:"sm"}),(0,o.jsx)(M.E,{color:"secondaryText",size:"sm",children:"This may take a minute to complete"})]}),(0,o.jsx)(y.h,{y:"xl"})]})]})})}function tI(e){let[t,n]=(0,i.useState)(),s=e.buyWithCryptoQuote,a=(0,i.useMemo)(()=>(0,r.Q4)(s.swapDetails.fromToken.chainId),[s]),c=(0,i.useMemo)(()=>(0,r.Q4)(s.swapDetails.toToken.chainId),[s]),l=s.swapDetails.fromToken.symbol||"",u=s.swapDetails.toToken.symbol||"",m=s.swapDetails.fromAmount,h=s.swapDetails.toAmount,p=s.swapDetails.toToken,x=s.swapDetails.fromToken,y=(0,i.useMemo)(()=>p.tokenAddress===d.DG?v.gr:{address:p.tokenAddress,name:p.name||"",symbol:p.symbol||""},[p]),f=(0,i.useMemo)(()=>x.tokenAddress===d.DG?v.gr:{address:x.tokenAddress,name:x.name||"",symbol:x.symbol||""},[x]);return t?(0,o.jsx)(tv,{title:e.title,onBack:e.onBack,onTryAgain:e.onTryAgain,swapTxHash:t,fromChain:a,client:e.client,onDone:e.onDone,transactionMode:e.transactionMode,isEmbed:e.isEmbed,quote:s,onSuccess:e.onSuccess}):(0,o.jsx)(tw,{title:e.title,setSwapTxHash:n,toChain:c,toAmount:h,toTokenSymbol:u,fromChain:a,toToken:y,fromAmount:m,fromToken:f,fromTokenSymbol:l,client:e.client,onBack:e.onBack,onTryAgain:e.onTryAgain,quote:s,isFiatFlow:e.isFiatFlow,payer:e.payer,preApprovedAmount:e.approvalAmount})}function tS(e){let t=(0,B.QP)(),n=(0,Q.X)({address:e.payerAccount.address,chain:e.chain,tokenAddress:(0,v.rk)(e.token)?void 0:e.token?.address,client:e.client},{enabled:!!e.chain&&!!e.token});return(0,o.jsxs)(f.mc,{bg:"tertiaryBg",style:{borderRadius:l.r8.lg,border:`1px solid ${t.colors.borderColor}`,...e.swapRequired?{borderBottom:"none",borderBottomLeftRadius:0,borderBottomRightRadius:0}:{}},children:[(0,o.jsxs)(f.mc,{flex:"row",gap:"sm",style:{justifyContent:"space-between",padding:l.YK.sm,borderBottom:`1px solid ${t.colors.borderColor}`},children:[(0,o.jsx)(X.k,{client:e.client,address:e.payerAccount.address}),e.token&&e.chain&&n.data?(0,o.jsxs)(f.mc,{flex:"row",gap:"3xs",center:"y",children:[(0,o.jsx)(M.E,{size:"xs",color:"secondaryText",weight:500,children:(0,J.j)(n.data,!1,4)}),(0,o.jsx)(w.C,{token:e.token,chain:e.chain,size:"xs",color:"secondaryText"})]}):e.token&&e.chain&&n.isLoading?(0,o.jsx)(Y.E,{width:"70px",height:l.J.xs}):null]}),(0,o.jsx)(tm,{token:e.token,chain:e.chain,client:e.client,isLoading:e.isLoading,value:e.value,onSelectToken:e.onSelectToken,style:{border:"none",borderRadius:0,borderBottomLeftRadius:e.token&&e.chain&&e.swapRequired?0:l.r8.lg,borderBottomRightRadius:e.token&&e.chain&&e.swapRequired?0:l.r8.lg}})]})}function tD(e){var t,n;let{setScreen:s,payer:c,client:l,toChain:u,tokenAmount:m,toToken:h,fromChain:p,fromToken:x,payOptions:k,disableTokenSelection:j}=e,T=e.payOptions?.paymentInfo?.sellerAddress||e.activeAccount.address,{drawerRef:b,drawerOverlayRef:A,isOpen:C,setIsOpen:D}=eS(),[E,W]=(0,i.useState)("fees"),B=(0,Q.X)({address:c.account.address,chain:p,tokenAddress:(0,v.rk)(x)?void 0:x?.address,client:l},{enabled:!!p&&!!x}),R=(0,v.rk)(x)?d.DG:x?.address?.toLowerCase(),L=(0,v.rk)(h)?d.DG:h.address.toLowerCase(),P=!!m&&!!p&&!!R&&(p?.id!==u.id||R!==L),z=(t=p&&x&&P?{fromAddress:c.account.address,toAddress:T,fromChainId:p.id,fromTokenAddress:(0,v.rk)(x)?d.DG:x.address,toChainId:u.id,toTokenAddress:(0,v.rk)(h)?d.DG:h.address,toAmount:m,client:l,purchaseData:k.purchaseData,paymentLinkId:e.paymentLinkId}:void 0,n={staleTime:3e4,refetchInterval:3e4,gcTime:3e4},(0,I.I)({...n,queryKey:["buyWithCryptoQuote",t],refetchInterval:2e4,queryFn:()=>{if(!t)throw Error("Swap params are required");return eH(t)},enabled:!!t,retry:!1})),F=(0,I.I)({queryKey:["allowance",c.account.address,z.data?.approvalData],queryFn:()=>z.data?.approvalData?(0,eO.nB)({contract:(0,S.P)({client:e.client,address:z.data.swapDetails.fromToken.tokenAddress,chain:(0,r.Q4)(z.data.swapDetails.fromToken.chainId)}),spender:z.data.approvalData.spenderAddress,owner:e.payer.account.address}):null,enabled:!!z.data?.approvalData,refetchOnMount:!0}),q=P?z.data?.swapDetails.fromAmount:m,N=!!q&&!!B.data&&Number(B.data.displayValue)<Number(q),O=!p||!x||P&&!z.data||N||F.isLoading,_=e.payer.wallet.getChain()?.id!==p?.id,U=!z.isLoading&&z.error?ex(z.error):void 0;return(0,o.jsxs)(f.mc,{flex:"column",gap:"lg",animate:"fadein",children:[C&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eI,{ref:A}),(0,o.jsx)(eA,{ref:b,close:()=>D(!1),children:"fees"===E&&z.data&&(0,o.jsxs)("div",{children:[(0,o.jsx)(M.E,{size:"lg",color:"primaryText",children:"Fees"}),(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsx)(ez,{quote:z.data})]})})]}),(0,o.jsxs)(f.mc,{flex:"column",gap:"sm",children:[(0,o.jsxs)(f.mc,{flex:"row",gap:"xxs",center:"y",children:[(0,o.jsx)(M.E,{size:"sm",children:"Pay with"}),x&&p?(0,o.jsx)(w.C,{token:x,chain:p,size:"sm",color:"secondaryText"}):"crypto"]}),(0,o.jsxs)("div",{children:[(0,o.jsx)(tS,{value:q||"",chain:p,token:x,isLoading:z.isLoading&&!q,client:l,freezeChainAndTokenSelection:j,payerAccount:e.payer.account,swapRequired:P,onSelectToken:e.showFromTokenSelector}),P&&p&&x&&(0,o.jsx)(eE,{quoteIsLoading:z.isLoading,estimatedSeconds:z.data?.swapDetails.estimated.durationSeconds,onViewFees:function(){z.data&&(D(!0),W("fees"))}})]}),U&&(0,o.jsx)("div",{children:(0,o.jsxs)("div",{children:[(0,o.jsx)(M.E,{color:"danger",size:"xs",center:!0,multiline:!0,children:U.title}),(0,o.jsx)(M.E,{size:"xs",center:!0,multiline:!0,children:U.message})]})}),!U&&N&&(0,o.jsxs)("div",{children:[(0,o.jsx)(M.E,{color:"danger",size:"xs",center:!0,multiline:!0,children:"Insufficient Funds"}),(0,o.jsx)(M.E,{size:"xs",center:!0,multiline:!0,children:"Select another token or pay with card."})]})]}),N||U?(0,o.jsx)(g.$n,{variant:"accent",fullWidth:!0,onClick:()=>e.showFromTokenSelector(),children:"Pay with another token"}):!_||!p||z.isLoading||F.isLoading||N||z.error?(0,o.jsx)(g.$n,{variant:O?"outline":"accent",fullWidth:!0,"data-disabled":O,disabled:O,onClick:async()=>{O||(!function(){if("direct_payment"!==e.payOptions.mode&&"fund_wallet"!==e.payOptions.mode||N||P){if("transaction"===e.payOptions.mode&&!N&&!P)return c.account.address!==T?s({id:"transfer-flow"}):e.onDone()}else s({id:"transfer-flow"});z.data&&s({id:"swap-flow",quote:z.data,approvalAmount:F.data??void 0})}(),(0,a.G)({event:"confirm_swap_quote",client:l,walletAddress:c.account.address,walletType:c.wallet.id,chainId:p.id,fromToken:(0,v.rk)(x)?void 0:x.address,toChainId:u.id,toToken:(0,v.rk)(h)?void 0:h.address}))},gap:"xs",children:z.isLoading?(0,o.jsxs)(o.Fragment,{children:["Getting price quote",(0,o.jsx)(eD.y,{size:"sm",color:"accentButtonText"})]}):"Continue"}):(0,o.jsx)(e6,{variant:"accent",fullWidth:!0,switchChain:async()=>{await e.payer.wallet.switchChain(p)}})]})}var tE=n(33593),tW=n(53135),tB=n(28318),tR=n(68338),tL=n(84368);function tP(e){let t=(0,u.L)(),n=(0,e4.F)(),o=(0,R.cj)(e.toChain);return(0,I.I)({queryKey:["wallets-and-balances",e.sourceSupportedTokens,e.toChain.id,e.toToken,e.mode,t?.address,n.map(e=>e.getAccount()?.address)],enabled:!!e.sourceSupportedTokens&&!!o.data&&!!t,queryFn:async()=>{let o=await Promise.all(n.map(async n=>{let o=await tz({wallet:n,accountAddress:t?.address,sourceSupportedTokens:e.sourceSupportedTokens||[],toChain:e.toChain,toToken:e.toToken,mode:e.mode,client:e.client});return[{id:n.id,address:n.getAccount()?.address||""},o]})),s=new Map;for(let e of o)s.set(e[0],e[1]);return s}})}async function tz({wallet:e,accountAddress:t,sourceSupportedTokens:n,toChain:o,toToken:s,mode:i,client:a}){let c=e.getAccount();if(!c)return[];let l=[],u=Object.keys(n).map(e=>(0,r.Q4)(Number(e))),m=function(e){let t=[];for(let n=0;n<e.length;n+=5)t.push(e.slice(n,n+5));return t}((await Promise.all(u.map(async e=>({chain:e,enabled:await (0,tB.isInsightEnabled)(e)})))).filter(e=>e.enabled).map(e=>e.chain));await Promise.all(m.map(async e=>{for(let t of(await (0,tR.y)({ownerAddress:c.address,chains:e,client:a}))){let e=n[t.chainId]?.find(e=>e.address.toLowerCase()===t.tokenAddress.toLowerCase());e&&l.push({balance:t,chain:(0,r.Q4)(t.chainId),token:e})}}));let h=(0,v.rk)(s)?{address:d.DG,name:o.nativeCurrency?.name||"",symbol:o.nativeCurrency?.symbol||"",icon:o.icon?.url}:s,p={...n,[o.id]:[h,...n[o.id]||[]]},x=[];for(let[e,n]of Object.entries(p)){let s=Number(e),d=(0,r.Q4)(s);for(let e of n){let n=(0,v.rk)(e);(!l.some(t=>t.chain.id===s&&t.token.address.toLowerCase()===e.address.toLowerCase())||n)&&x.push((async()=>{try{let s=await (0,tL.m)({address:c.address,chain:d,tokenAddress:n?void 0:e.address,client:a});(e.address.toLowerCase()===h.address.toLowerCase()&&d.id===o.id?("fund_wallet"!==i||c.address!==t)&&s.value>0n:s.value>0n)&&l.push({balance:s,chain:d,token:e})}catch(t){console.warn(`Failed to fetch balance for ${e.symbol} on chain ${s}`,t)}})())}}await Promise.all(x);{let e={};for(let t of l){let n=`${t.chain.id}-${t.token.address.toLowerCase()}`;e[n]||(e[n]=t)}l.splice(0,l.length,...Object.values(e))}return l.sort((e,t)=>{let n=h.address;return e.chain.id===o.id&&e.token.address===n?-1:t.chain.id===o.id&&t.token.address===n?1:e.chain.id===o.id?-1:t.chain.id===o.id?1:e.chain.id-t.chain.id}),l}function tF(e){let t=(0,e4.F)(),n=(0,u.L)(),s=(0,L.z)(),i=(0,R.cj)(e.toChain),r=(0,B.QP)(),d=tP({client:e.client,sourceSupportedTokens:e.sourceSupportedTokens||[],toChain:e.toChain,toToken:e.toToken,mode:e.mode});if(d.isLoading||i.isLoading||!i.data||!e.sourceSupportedTokens)return(0,o.jsx)(p.x,{});let c=Array.from(d.data?.entries()||[]).filter(([t])=>!e.hiddenWallets?.includes(t.id)).filter(([,e])=>e.some(e=>e.balance.value>0));return(0,o.jsxs)(f.mc,{animate:"fadein",style:{minHeight:"200px"},children:[0===c.length?(0,o.jsx)(f.mc,{flex:"column",gap:"xs",py:"lg",children:(0,o.jsxs)(M.E,{size:"xs",color:"secondaryText",center:!0,children:["No suitable payment token found",(0,o.jsx)("br",{}),"in connected wallets"]})}):(0,o.jsxs)(f.mc,{flex:"column",gap:"xs",children:[(0,o.jsx)(M.E,{size:"sm",children:"Select payment token"}),(0,o.jsx)(y.h,{y:"xs"})]}),(0,o.jsx)(f.mc,{scrollY:!0,style:{maxHeight:"350px"},children:(0,o.jsxs)(f.mc,{flex:"column",gap:"sm",children:[c.map(([i,r])=>{let d=i.address,c=t.find(e=>e.getAccount()?.address===d);return c?(0,o.jsx)(tq,{wallet:c,balances:r,client:e.client,address:d,onClick:(t,o,i)=>{(0,a.G)({event:"choose_payment_method_token",client:e.client,walletAddress:n?.address,walletType:s?.id,chainId:i.id,fromToken:(0,v.rk)(o)?void 0:o.address,toToken:(0,v.rk)(e.toToken)?void 0:e.toToken.address,toChainId:e.toChain.id}),e.onSelectToken(t,o,i)}},i.id):null}),c.length>0&&(0,o.jsx)(tW.l,{text:"OR"}),(0,o.jsx)(g.$n,{variant:"secondary",fullWidth:!0,onClick:()=>{(0,a.G)({event:"choose_payment_method_another_wallet",client:e.client,walletAddress:n?.address,walletType:s?.id,toChainId:e.toChain.id,toToken:(0,v.rk)(e.toToken)?void 0:e.toToken.address}),e.onConnect()},bg:"tertiaryBg",style:{border:`1px solid ${r.colors.borderColor}`,padding:l.YK.sm},children:(0,o.jsxs)(f.mc,{flex:"row",gap:"sm",center:"y",expand:!0,color:"secondaryIconColor",children:[(0,o.jsx)(V.l,{size:l.RK.md}),(0,o.jsx)(M.E,{size:"sm",color:"primaryText",children:"Pay with another wallet"})]})}),e.fiatSupported&&(0,o.jsx)(g.$n,{variant:"secondary",fullWidth:!0,onClick:()=>{(0,a.G)({event:"choose_payment_method_with_card",client:e.client,walletAddress:n?.address,walletType:s?.id,toChainId:e.toChain.id,toToken:(0,v.rk)(e.toToken)?void 0:e.toToken.address}),e.onPayWithFiat()},bg:"tertiaryBg",style:{border:`1px solid ${r.colors.borderColor}`,padding:l.YK.sm},children:(0,o.jsxs)(f.mc,{flex:"row",gap:"sm",center:"y",expand:!0,color:"secondaryIconColor",children:[(0,o.jsx)(eg.IJm,{width:l.RK.md,height:l.RK.md}),(0,o.jsx)(M.E,{size:"sm",color:"primaryText",children:"Pay with card"})]})})]})})]})}function tq(e){let t=(0,B.QP)(),n=e.balances,s=(0,u.L)(),{disconnect:i}=(0,tE.u)(),a=s?.address===e.address;return(0,o.jsxs)(f.mc,{flex:"column",style:{borderRadius:l.r8.lg,border:`1px solid ${t.colors.borderColor}`},children:[(0,o.jsxs)(f.mc,{flex:"row",gap:"sm",bg:"tertiaryBg",style:{justifyContent:"space-between",borderTopRightRadius:l.r8.lg,borderTopLeftRadius:l.r8.lg,padding:l.YK.sm,paddingRight:l.YK.xs,borderBottom:`1px solid ${t.colors.borderColor}`},children:[(0,o.jsx)(X.k,{...e}),!a&&(0,o.jsx)(g.$n,{variant:"ghost",onClick:()=>i(e.wallet),style:{padding:l.YK.xxs,color:t.colors.secondaryText},children:(0,o.jsx)(eg.MKb,{width:l.RK.sm,height:l.RK.sm})})]}),(0,o.jsx)(f.mc,{flex:"column",children:e.balances.length>0?n.map((s,i)=>(0,o.jsx)(tN,{client:e.client,onClick:()=>e.onClick(e.wallet,s.token,s.chain),tokenBalance:s,wallet:e.wallet,style:{borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomRightRadius:i===n.length-1?l.r8.lg:0,borderBottomLeftRadius:i===n.length-1?l.r8.lg:0,borderBottom:i===n.length-1?"none":`1px solid ${t.colors.borderColor}`}},`${s.token.address}-${s.chain.id}`)):(0,o.jsx)(f.mc,{style:{padding:l.YK.sm},children:(0,o.jsx)(M.E,{size:"sm",color:"secondaryText",children:"Insufficient Funds"})})})]})}function tN(e){let{tokenBalance:t,wallet:n,onClick:s,client:i,style:a}=e,r=(0,R.Kj)(t.chain);return(0,o.jsxs)(tM,{onClick:()=>s(t.token,n),variant:"secondary",style:{...a,display:"flex",justifyContent:"space-between",minWidth:0},children:[(0,o.jsxs)(f.mc,{flex:"row",center:"y",gap:"sm",style:{flex:"1 1 50%",minWidth:0,maxWidth:"50%",overflow:"hidden",flexWrap:"nowrap"},children:[(0,o.jsx)(q.x,{token:t.token,chain:t.chain,size:"md",client:i}),(0,o.jsxs)(f.mc,{flex:"column",gap:"4xs",style:{minWidth:0},children:[(0,o.jsx)(M.E,{size:"xs",color:"primaryText",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.token.symbol}),r&&(0,o.jsx)(M.E,{size:"xs",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.name})]})]}),(0,o.jsxs)(f.mc,{flex:"row",center:"y",gap:"4xs",color:"secondaryText",style:{flex:"1 1 50%",maxWidth:"50%",minWidth:0,justifyContent:"flex-end",flexWrap:"nowrap"},children:[(0,o.jsxs)(f.mc,{flex:"column",color:"secondaryText",gap:"4xs",style:{alignItems:"flex-end",minWidth:0,overflow:"hidden"},children:[(0,o.jsx)(M.E,{size:"xs",color:"primaryText",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(0,J.j)(t.balance,!0,2)}),(0,o.jsx)(tx,{tokenAmount:t.balance.displayValue,token:t.token,chain:t.chain,client:i,size:"xs"})]}),(0,o.jsx)(eg.vKP,{width:l.RK.md,height:l.RK.md,style:{flexShrink:0}})]})]})}let tM=(0,et.A)(g.$n)(e=>{let t=(0,B.QP)();return{background:"transparent",justifyContent:"space-between",flexWrap:"nowrap",flexDirection:"row",padding:l.YK.sm,paddingRight:l.YK.xs,gap:l.YK.sm,"&:hover":{background:t.colors.secondaryButtonBg,transform:"scale(1.01)"},transition:"background 200ms ease, transform 150ms ease",...e.style}});var tO=n(84567),t_=n(28850);async function tU(e){let{chainId:t,tokenAddress:n,sender:o,receiver:s,client:i,amount:a,purchaseData:d,feePayer:c,paymentLinkId:l}=e,u=(0,ec.getClientFetch)(i),m=new URL(`${(0,ed.getThirdwebBaseUrl)("bridge")}/v1/transfer/prepare`),h=await u(m.toString(),{method:"POST",headers:{"Content-Type":"application/json"},body:(0,el.stringify)({transferAmountWei:a.toString(),amount:a.toString(),chainId:t.toString(),tokenAddress:n,sender:o,receiver:s,purchaseData:d,feePayer:c,paymentLinkId:l})});if(!h.ok){let e=await h.json();throw new eu.h({code:e.code||"UNKNOWN_ERROR",message:e.message||h.statusText,correlationId:e.correlationId||void 0,statusCode:h.status})}let{data:p}=await h.json();return{originAmount:BigInt(p.originAmount),destinationAmount:BigInt(p.destinationAmount),blockNumber:p.blockNumber?BigInt(p.blockNumber):void 0,timestamp:p.timestamp,estimatedExecutionTimeMs:p.estimatedExecutionTimeMs,steps:p.steps.map(e=>({...e,transactions:e.transactions.map(e=>({...e,value:e.value?BigInt(e.value):void 0,client:i,chain:(0,r.xH)(e.chainId)}))})),intent:{chainId:t,tokenAddress:n,amount:a,sender:o,receiver:s,feePayer:c}}}async function tK(e){try{let t,n=(0,S.P)({address:e.tokenAddress,chain:(0,r.Q4)(e.chainId),client:e.client}),o=n.address.toLowerCase()===d.DG?18:await (0,D.decimals)({contract:n}),s=eU.HT(e.amount,o),i=await tU({chainId:e.chainId,tokenAddress:e.tokenAddress,amount:s,sender:e.fromAddress,receiver:e.toAddress,client:e.client,feePayer:e.feePayer,paymentLinkId:e.paymentLinkId}),a=i.steps[0];if(!a)throw Error("This quote is incompatible with getBuyWithCryptoTransfer. Please use Bridge.Transfer.prepare instead.");let c=a.transactions.filter(e=>"approval"===e.action);if(c.length>1)throw Error("This quote is incompatible with getBuyWithCryptoTransfer. Please use Bridge.Transfer.prepare instead.");let l=c[0];if(l){let e=eK.HT(["function approve(address spender, uint256 amount)"]),[n,o]=eK.Hw(e,l.data);t={chainId:a.originToken.chainId,tokenAddress:a.originToken.address,spenderAddress:n,amountWei:o.toString()}}let u=a.transactions.filter(e=>"approval"!==e.action);if(u.length>1)throw Error("This quote is incompatible with getBuyWithCryptoTransfer. Please use Bridge.Transfer.prepare instead.");let m=u[0];if(!m)throw Error("This quote is incompatible with getBuyWithCryptoTransfer. Please use Bridge.Transfer.prepare instead.");return{transactionRequest:{...m,extraGas:50000n},approvalData:t,fromAddress:e.fromAddress,toAddress:e.toAddress,paymentToken:{token:{tokenAddress:a.originToken.address,chainId:a.originToken.chainId,decimals:a.originToken.decimals,symbol:a.originToken.symbol,name:a.originToken.name,priceUSDCents:100*a.originToken.priceUsd},amountWei:i.originAmount.toString(),amount:eU.GP(i.originAmount,a.originToken.decimals).toString(),amountUSDCents:Number(eU.GP(i.originAmount,a.originToken.decimals))*a.originToken.priceUsd*100},processingFee:{token:{tokenAddress:a.originToken.address,chainId:a.originToken.chainId,decimals:a.originToken.decimals,symbol:a.originToken.symbol,name:a.originToken.name,priceUSDCents:100*a.originToken.priceUsd},amountWei:"sender"===e.feePayer?(i.originAmount-i.destinationAmount).toString():"0",amount:"sender"===e.feePayer?eU.GP(i.originAmount-i.destinationAmount,a.originToken.decimals).toString():"0",amountUSDCents:"sender"===e.feePayer?Number(eU.GP(i.originAmount-i.destinationAmount,a.originToken.decimals))*a.originToken.priceUsd*100:0},estimatedGasCostUSDCents:0,client:e.client}}catch(e){throw console.error("Error getting buy with crypto transfer",e),e}}async function t$(e){let t=await (0,eX.sendTransaction)(e);return(0,e0.L)(t)}var tG=n(78639);function tH(e){let{title:t,onBack:n,receiverAddress:s,client:c,payer:u,onDone:m,chain:h,token:p,tokenAmount:x,transactionMode:k,setTransactionHash:w,payOptions:j,paymentLinkId:T}=e,[b,A]=(0,i.useState)("transfer"),[C,D]=(0,i.useState)({id:"idle"}),E=(0,I.I)({queryKey:["transfer",(0,v.rk)(p)?d.DG:p.address,x,s,u.account.address,j?.purchaseData],queryFn:async()=>await tK({client:c,fromAddress:u.account.address,toAddress:s,chainId:h.id,tokenAddress:(0,v.rk)(p)?d.DG:p.address,amount:x,purchaseData:j?.purchaseData,feePayer:j?.mode==="direct_payment"?j.paymentInfo.feePayer:void 0,paymentLinkId:T}),refetchInterval:3e4}),B=(0,i.useMemo)(()=>"approve"===b&&"error"===C.id&&C.error?C.error.toLowerCase().includes("user rejected")||C.error.toLowerCase().includes("user closed modal")||C.error.toLowerCase().includes("user denied")?{title:"Failed to Approve",message:"Your wallet rejected the approval request."}:{title:"Failed to Approve",message:"Your wallet failed to approve the transaction for an unknown reason. Please try again or contact support."}:("transfer"===b||"execute"===b)&&"error"===C.id&&C.error?C.error.toLowerCase().includes("user rejected")?{title:"Failed to Confirm",message:"Your wallet rejected the confirmation request."}:{title:"Failed to Confirm",message:"Your wallet failed to confirm the transaction for an unknown reason. Please try again or contact support."}:void 0,[b,C]);if(E.isLoading)return(0,o.jsxs)(f.mc,{p:"lg",children:[(0,o.jsx)(f.rQ,{title:t,onBack:n}),(0,o.jsxs)(f.mc,{flex:"column",center:"both",style:{minHeight:"300px"},children:[(0,o.jsx)(y.h,{y:"xl"}),(0,o.jsx)(eD.y,{size:"xl",color:"secondaryText"}),(0,o.jsx)(y.h,{y:"xl"})]})]});let R=E.data?.paymentToken.amount||x;return(0,o.jsxs)(f.mc,{p:"lg",children:[(0,o.jsx)(f.rQ,{title:t,onBack:n}),(0,o.jsx)(y.h,{y:"xl"}),k?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tf,{steps:2,currentStep:"transfer"===b?1:2}),(0,o.jsx)(y.h,{y:"sm"}),(0,o.jsx)(M.E,{size:"sm",children:"transfer"===b?"Step 1 of 2 - Transfer funds":"Step 2 of 2 - Finalize transaction"}),(0,o.jsx)(y.h,{y:"md"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(M.E,{size:"sm",children:"Confirm payment"}),(0,o.jsx)(y.h,{y:"md"})]}),(0,o.jsx)(tk,{sender:u.account.address,receiver:s,client:c,fromToken:p,fromChain:h,toToken:p,toChain:h,fromAmount:k?x:R,toAmount:x}),(0,o.jsx)(y.h,{y:"lg"}),k&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.h,{y:"sm"}),(0,o.jsxs)(f.mc,{gap:"sm",flex:"row",style:{justifyContent:"space-between"},center:"y",color:"accentText",children:[(0,o.jsx)(tn,{isDone:"execute"===b,isActive:"transfer"===b,label:"transfer"===b?"Transfer":"Done"}),(0,o.jsx)(tj,{}),(0,o.jsx)(tn,{isDone:!1,label:"Finalize",isActive:"execute"===b})]}),(0,o.jsx)(y.h,{y:"lg"})]}),B&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tg,{title:B.title,message:B.message}),(0,o.jsx)(y.h,{y:"md"})]}),!k&&"execute"===b&&"done"===C.id&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(f.mc,{flex:"row",gap:"xs",center:"both",color:"success",children:[(0,o.jsx)(eg.KaV,{width:l.RK.sm,height:l.RK.sm}),(0,o.jsx)(M.E,{color:"success",size:"sm",children:"Payment completed"})]}),(0,o.jsx)(y.h,{y:"md"})]}),u.chain.id!==h.id?(0,o.jsx)(e6,{fullWidth:!0,variant:"accent",switchChain:async()=>{await e.payer.wallet.switchChain(h)}}):(0,o.jsxs)(g.$n,{variant:"accent",fullWidth:!0,disabled:"pending"===C.id,onClick:async()=>{if("execute"===b)return void m();try{if(D({id:"pending"}),k){let t=(0,v.rk)(p)?(0,tG.prepareTransaction)({client:c,chain:h,to:s,value:(0,W.fq)(x)}):(0,t_.k)({contract:(0,S.P)({address:p.address,chain:h,client:c}),to:s,amount:x}),[n,o]=await Promise.all([t$({account:e.payer.account,transaction:t}),(0,tO.getCurrencyMetadata)({contract:(0,S.P)({address:(0,v.rk)(p)?d.DG:p.address,chain:h,client:c})})]);(0,a.G)({client:e.client,walletAddress:u.account.address,walletType:u.wallet.id,toChainId:h.id,toToken:(0,v.rk)(p)?void 0:p.address,event:"transfer_confirmation_success_transaction_mode"}),e.onSuccess?.(function(e){let{token:t,chain:n,tokenMetadata:o,tokenAmount:s,fromAddress:i,toAddress:a,transaction:r}=e;return{status:"COMPLETED",subStatus:"SUCCESS",swapType:"TRANSFER",quote:{createdAt:new Date().toISOString(),fromToken:{chainId:n.id,tokenAddress:(0,v.rk)(t)?d.DG:t.address,decimals:o.decimals,symbol:o.symbol,name:o.name,priceUSDCents:0},toToken:{chainId:n.id,tokenAddress:(0,v.rk)(t)?d.DG:t.address,decimals:o.decimals,symbol:o.symbol,name:o.name,priceUSDCents:0},fromAmountWei:(0,W.fq)(s).toString(),fromAmount:s,toAmountWei:(0,W.fq)(s).toString(),toAmount:s,toAmountMin:s,toAmountMinWei:(0,W.fq)(s).toString(),estimated:{feesUSDCents:0,gasCostUSDCents:0,slippageBPS:0,toAmountMinUSDCents:0,toAmountUSDCents:0,fromAmountUSDCents:0,durationSeconds:0}},fromAddress:i,toAddress:a,source:{transactionHash:r.transactionHash,amount:s,amountWei:(0,W.fq)(s).toString(),amountUSDCents:0,completedAt:new Date().toISOString(),token:{chainId:n.id,tokenAddress:(0,v.rk)(t)?d.DG:t.address,decimals:o.decimals,symbol:o.symbol,name:o.name,priceUSDCents:0}}}}({token:p,chain:h,tokenMetadata:o,tokenAmount:k?x:R,fromAddress:u.account.address,toAddress:s,transaction:n})),A("execute"),D({id:"idle"})}else{let t=E.data;if(!t)throw Error("Transfer data not found");if(t.approvalData&&await (0,eO.nB)({contract:(0,S.P)({client:c,address:t.approvalData.tokenAddress,chain:(0,r.Q4)(t.approvalData.chainId)}),spender:t.approvalData.spenderAddress,owner:u.account.address})<BigInt(t.approvalData.amountWei)){A("approve"),(0,a.G)({client:e.client,walletAddress:u.account.address,walletType:u.wallet.id,toChainId:h.id,toToken:(0,v.rk)(p)?void 0:p.address,event:"prompt_transfer_approval"});let n=(0,e_.S)({contract:(0,S.P)({client:c,address:t.approvalData.tokenAddress,chain:(0,r.Q4)(t.approvalData.chainId)}),spender:t.approvalData.spenderAddress,amountWei:BigInt(t.approvalData.amountWei)});await t$({account:e.payer.account,transaction:n}),(0,a.G)({client:e.client,walletAddress:u.account.address,walletType:u.wallet.id,toChainId:h.id,toToken:(0,v.rk)(p)?void 0:p.address,event:"transfer_approval_success"})}(0,a.G)({client:e.client,walletAddress:u.account.address,walletType:u.wallet.id,toChainId:h.id,toToken:(0,v.rk)(p)?void 0:p.address,event:"prompt_transfer_confirmation"}),A("transfer");let n=t.transactionRequest,o=await (0,eX.sendTransaction)({account:e.payer.account,transaction:n});w(o.transactionHash),D({id:"idle"}),(0,a.G)({client:e.client,walletAddress:u.account.address,walletType:u.wallet.id,toChainId:h.id,toToken:(0,v.rk)(p)?void 0:p.address,event:"transfer_confirmation_success"})}}catch(e){console.error(e),D({id:"error",error:"error"in e?e.error?.message:e?.message})}},gap:"xs",children:["execute"===b&&("done"===C.id?"Done":"Continue"),"transfer"===b&&("pending"===C.id?"Confirming":"Confirm"),"approve"===b&&("pending"===C.id?"Approving":"Approve"),"pending"===C.id&&(0,o.jsx)(eD.y,{size:"sm",color:"accentButtonText"})]})]})}function tQ(e){let[t,n]=(0,i.useState)();return t?(0,o.jsx)(tv,{title:e.title,onBack:e.onBack,onTryAgain:e.onTryAgain,swapTxHash:t,fromChain:e.chain,client:e.client,onDone:e.onDone,transactionMode:!1,isEmbed:e.isEmbed,quote:void 0,onSuccess:e.onSuccess}):(0,o.jsx)(tH,{...e,setTransactionHash:n})}function tY(e){let t=e.payOptions.buyWithCrypto?e.payOptions.buyWithCrypto.testMode:void 0,n=G(e.client,t);if(n.isError)return(0,o.jsx)(f.mc,{style:{minHeight:"350px"},fullHeight:!0,flex:"row",center:"both",children:(0,o.jsx)(h.W,{title:"Something went wrong",onTryAgain:n.refetch})});if(!n.data)return(0,o.jsx)(p.x,{});let s=e.supportedTokens?Object.entries(e.supportedTokens).map(([e,t])=>({chain:(0,r.Q4)(Number.parseInt(e)),tokens:t.map(e=>({...e,buyWithCryptoEnabled:!0,buyWithFiatEnabled:!0}))})):n.data;return(0,o.jsx)(tV,{...e,supportedDestinations:s})}function tV(e){var t;let{client:n,supportedDestinations:a,connectLocale:c,payOptions:l}=e,h=(0,u.L)(),{payer:p,setPayer:x}=function(){let e=(0,L.z)(),t=(0,u.L)(),n=(0,tl.w)(),[o,s]=(0,i.useState)();return(0,i.useEffect)(()=>{let e=o?.wallet;function t(){if(!e)return void s(void 0);let t=e.getAccount(),n=e.getChain();t&&n?s({account:t,chain:n,wallet:e}):s(void 0)}if(e){let n=e.subscribe("chainChanged",t),o=e.subscribe("accountChanged",t);return()=>{n(),o()}}},[o]),{payer:o||(t&&n&&e?{account:t,chain:n,wallet:e}:void 0),setPayer:s}}(),[y,g]=(0,i.useState)({id:"main"}),{tokenAmount:k,setTokenAmount:w,toChain:j,setToChain:T,deferredTokenAmount:b,toToken:S,setToToken:D}=function(e){let{payOptions:t,supportedDestinations:n}=e,o=t?.prefillBuy,s=(0,tl.w)(),a=o?.amount||"",[r,d]=(0,i.useState)(a),c=(0,tu.o)(r,300);(0,i.useEffect)(()=>{o?.amount&&d(o.amount),o?.chain&&u(o.chain),o?.token&&h(o.token)},[o?.amount,o?.chain,o?.token]);let[l,u]=(0,i.useState)(o?.chain||"transaction"===t.mode&&t.transaction?.chain||"direct_payment"===t.mode&&t.paymentInfo?.chain||n.find(e=>e.chain.id===s?.id)?.chain||n[0]?.chain||tc),[m,h]=(0,i.useState)(o?.token||"direct_payment"===t.mode&&t.paymentInfo.token||v.gr);return{toChain:l,setToChain:u,toToken:m,setToToken:h,tokenAmount:r,setTokenAmount:d,deferredTokenAmount:c}}({payOptions:l,supportedDestinations:a}),[E,W]=(0,i.useState)(!1),B=(0,i.useCallback)(()=>{g({id:"main"}),e.onDone()},[e.onDone]),R=(t={client:e.client,destinationChainId:j.id,destinationTokenAddress:(0,v.rk)(S)?d.DG:S.address},(0,I.I)({queryKey:["source-tokens",t],queryFn:async()=>{let e=await U.J({client:t.client,destinationChainId:t.destinationChainId,destinationTokenAddress:t.destinationTokenAddress,maxSteps:1,sortBy:"popularity",limit:50}),n=new Set,o=new Set,s=[];for(let t of e){let e=`${t.originToken.chainId}:${t.originToken.address}`;if(!n.has(e)){n.add(e),o.has(t.originToken.chainId)||o.add(t.originToken.chainId);let i=s[t.originToken.chainId];i||(s[t.originToken.chainId]=[]),s[t.originToken.chainId]=[...i||[],{address:_.cM(t.originToken.address),buyWithCryptoEnabled:!0,buyWithFiatEnabled:!0,name:t.originToken.name,symbol:t.originToken.symbol,icon:t.originToken.iconUri}]}}return[...o].map(e=>({chain:(0,r.Q4)(e),tokens:s[e]||[]}))}})),P=(0,i.useMemo)(()=>t0(a,l,e.supportedTokens),[e.supportedTokens,a,l]),z=(0,i.useMemo)(()=>{if(R.data)return t0(R.data,l,e.supportedTokens)},[e.supportedTokens,R.data,l]);tP({client:e.client,sourceSupportedTokens:z||[],toChain:j,toToken:S,mode:l.mode});let{fromChain:F,setFromChain:q,fromToken:N,setFromToken:M}=function(e){let{payOptions:t}=e,[n,o]=(0,i.useState)(),s=!1!==t.buyWithCrypto&&t.buyWithCrypto?.prefillSource?.chain||"transaction"===t.mode&&t.transaction?.chain||"direct_payment"===t.mode&&t.paymentInfo?.chain,[a,r]=(0,i.useState)(),d=!1!==t.buyWithCrypto&&t.buyWithCrypto?.prefillSource?.token||"direct_payment"===t.mode&&t.paymentInfo.token;return{fromChain:n||s||void 0,setFromChain:o,fromToken:a||d||void 0,setFromToken:r}}({payOptions:l,supportedSources:R.data||[]}),{selectedCurrency:O,setSelectedCurrency:K}=function(e){let{payOptions:t}=e,n=(!1!==t.buyWithFiat?t.buyWithFiat?.prefillSource?.currency:void 0)||function(){try{let e=Intl.DateTimeFormat().resolvedOptions().timeZone.toLowerCase();if(e.includes("london"))return"GBP";if(e.includes("europe"))return"EUR";if(e.includes("japan"))return"JPY";if(e.includes("canada"))return"CAD";if(e.includes("australia"))return"AUD";if(e.includes("new zealand"))return"NZD";return"USD"}catch{return"USD"}}(),[o,s]=(0,i.useState)(eo.find(e=>e.shorthand===n)||en);return{selectedCurrency:o,setSelectedCurrency:s}}({payOptions:l}),$=function(e){let{payOptions:t,supportedDestinations:n,toChain:o,toToken:s}=e,{fiat:i,swap:a}=function(){let e=n.find(e=>e.chain.id===o.id);if(!e)return{fiat:!1,swap:!1};let t=(0,v.rk)(s)?d.DG:s.address,i=e.tokens.find(e=>e.address.toLowerCase()===t.toLowerCase());return i?{fiat:i.buyWithFiatEnabled,swap:i.buyWithCryptoEnabled}:{fiat:!0,swap:!0}}();return{buyWithFiatEnabled:!1!==t.buyWithFiat&&i,buyWithCryptoEnabled:!1!==t.buyWithCrypto&&a}}({payOptions:e.payOptions,supportedDestinations:e.supportedDestinations,toChain:j,toToken:S}),G=!1===$.buyWithCryptoEnabled&&!1===$.buyWithFiatEnabled,H=(0,s.jE)(),Q=(0,i.useCallback)(t=>{e.payOptions.onPurchaseSuccess?.({type:"crypto",status:t}),(0,m.V)(H)},[e.payOptions.onPurchaseSuccess,H]),Y=(0,i.useCallback)(t=>{e.payOptions.onPurchaseSuccess?.({type:"fiat",status:t}),(0,m.V)(H)},[e.payOptions.onPurchaseSuccess,H]);if("connect-payer-wallet"===y.id)return(0,o.jsx)(C.r,{accountAbstraction:e.connectOptions?.accountAbstraction,appMetadata:e.connectOptions?.appMetadata,chain:j||e.connectOptions?.chain,chains:[j,...e.connectOptions?.chains||[]],client:e.client,connectLocale:e.connectLocale,isEmbed:e.isEmbed,onBack:()=>g(y.backScreen),onSelect:e=>{let t=e.getAccount(),n=e.getChain();e&&t&&n&&x({account:t,chain:n,wallet:e})},hiddenWallets:e.hiddenWallets,recommendedWallets:e.connectOptions?.recommendedWallets,showAllWallets:e.connectOptions?.showAllWallets===void 0||e.connectOptions?.showAllWallets,walletConnect:e.connectOptions?.walletConnect,wallets:e.connectOptions?.wallets?.filter(e=>"inApp"!==e.id)});if("swap-flow"===y.id&&p)return(0,o.jsx)(tI,{title:e.title,transactionMode:"transaction"===l.mode,isEmbed:e.isEmbed,client:n,onBack:()=>{g({id:"buy-with-crypto"})},buyWithCryptoQuote:y.quote,payer:p,isFiatFlow:!1,onDone:B,onTryAgain:()=>{g({id:"buy-with-crypto"})},onSuccess:Q,approvalAmount:y.approvalAmount});if("fiat-flow"===y.id&&p){let t=e.payOptions?.paymentInfo?.sellerAddress||p.account.address;return(0,o.jsx)(tr,{title:e.title,transactionMode:"transaction"===l.mode,paymentLinkId:e.paymentLinkId,quote:y.quote,onBack:()=>{g({id:"buy-with-fiat"})},client:n,testMode:!1!==e.payOptions.buyWithFiat&&e.payOptions.buyWithFiat?.testMode===!0,theme:"string"==typeof e.theme?e.theme:e.theme.type,onDone:B,isEmbed:e.isEmbed,payer:p,receiverAddress:t,onSuccess:Y})}if("transfer-flow"===y.id&&p&&h){let t=e.payOptions?.paymentInfo?.sellerAddress||h.address;return(0,o.jsx)(tQ,{title:e.title,onBack:()=>g({id:"buy-with-crypto"}),payer:p,client:e.client,chain:j,token:S,tokenAmount:k,receiverAddress:t,transactionMode:"transaction"===e.payOptions.mode,payOptions:l,isEmbed:e.isEmbed,onDone:B,onTryAgain:()=>{g({id:"buy-with-crypto"})},onSuccess:Q,paymentLinkId:e.paymentLinkId})}if("select-currency"===y.id){let e=()=>g(y.backScreen);return(0,o.jsx)(ei,{onSelect:t=>{e(),K(t)},onBack:e})}if("select-to-token"===y.id){let t=a.map(e=>e.chain),s=()=>g(y.backScreen),i=l?.prefillBuy?.allowEdits;return i?.token===!1?(0,o.jsx)(t1,{chains:t,client:e.client,connectLocale:e.connectLocale,setChain:T,goBack:s}):(0,o.jsx)(A.T,{onBack:s,tokenList:((j?.id?P[j.id]:void 0)||[]).filter(e=>e.address.toLowerCase()!==d.DG.toLowerCase()),onTokenSelect:e=>{D(e),s()},chain:j,chainSelection:i?.chain!==!1?{chains:t,select:e=>{T(e)}}:void 0,connectLocale:c,client:n,modalTitle:e.title})}return(0,o.jsx)(f.mc,{animate:"fadein",children:(0,o.jsxs)("div",{children:["main"===y.id&&(0,o.jsx)(tZ,{title:e.title,payerAccount:p?.account,client:n,onSelectBuyToken:()=>g({id:"select-to-token",backScreen:y}),payOptions:l,setTokenAmount:w,setToChain:T,setToToken:D,setFromChain:q,setFromToken:M,toChain:j,toToken:S,tokenAmount:k,connectOptions:e.connectOptions,setScreen:g,supportedDestinations:a,onBack:e.onBack,theme:e.theme,hasEditedAmount:E,setHasEditedAmount:W,enabledPaymentMethods:$}),("select-payment-method"===y.id||"buy-with-crypto"===y.id||"buy-with-fiat"===y.id||"select-from-token"===y.id)&&p&&(0,o.jsxs)(tX,{disabled:"prefillBuy"in l&&l.prefillBuy?.allowEdits?.amount===!1||"fund_wallet"!==l.mode,title:e.title,selectedChain:j,selectedToken:S,tokenAmount:k,setTokenAmount:w,client:n,onBack:()=>{("buy-with-crypto"===y.id||"buy-with-fiat"===y.id)&&$.buyWithCryptoEnabled?g({id:"select-from-token",backScreen:{id:"main"}}):"select-from-token"===y.id?g(y.backScreen):g({id:"main"})},children:["buy-with-crypto"===y.id&&h&&(0,o.jsx)(tD,{setScreen:g,paymentLinkId:e.paymentLinkId,tokenAmount:b,toChain:j,toToken:S,fromChain:F,fromToken:N,showFromTokenSelector:()=>{g({id:"select-from-token",backScreen:y})},payer:p,client:n,isEmbed:e.isEmbed,onDone:B,payOptions:l,connectLocale:c,connectOptions:e.connectOptions,setPayer:x,activeAccount:h,setTokenAmount:w,setHasEditedAmount:W,disableTokenSelection:!0===G||!1!==l.buyWithCrypto&&l.buyWithCrypto?.prefillSource?.allowEdits?.chain===!1&&l.buyWithCrypto?.prefillSource?.allowEdits?.token===!1}),"buy-with-fiat"===y.id&&(0,o.jsx)(eN,{setScreen:g,tokenAmount:b,toChain:j,toToken:S,selectedCurrency:O,client:n,isEmbed:e.isEmbed,onDone:B,payOptions:l,theme:e.theme,showCurrencySelector:()=>{g({id:"select-currency",backScreen:y})},payer:p,setTokenAmount:w,setHasEditedAmount:W,paymentLinkId:e.paymentLinkId}),"select-from-token"===y.id&&R.data&&z&&(0,o.jsx)(tF,{fiatSupported:!1!==e.payOptions.buyWithFiat,client:e.client,sourceTokens:z,sourceSupportedTokens:z,toChain:j,toToken:S,tokenAmount:k,mode:l.mode,hiddenWallets:e.hiddenWallets,onConnect:()=>{g({id:"connect-payer-wallet",backScreen:y})},onPayWithFiat:()=>{g({id:"buy-with-fiat"})},onSelectToken:(e,t,n)=>{let o=e.getAccount();o&&(x({account:o,chain:n,wallet:e}),M(t),q(n)),g({id:"buy-with-crypto"})}})]})]})})}function tJ(e){return(0,o.jsx)("div",{children:(0,o.jsxs)(f.mc,{flex:"row",gap:"sm",center:"y",style:{justifyContent:"space-between"},children:[(0,o.jsxs)(f.mc,{flex:"row",gap:"xxs",center:"y",children:[(0,o.jsx)(k.pd,{variant:"outline",pattern:"^[0-9]*[.,]?[0-9]*$",inputMode:"decimal",tabIndex:-1,placeholder:"0",type:"text","data-placeholder":""===e.tokenAmount,value:e.tokenAmount||"0",disabled:e.disabled,onClick:t=>{""===e.tokenAmount&&t.currentTarget.setSelectionRange(t.currentTarget.value.length,t.currentTarget.value.length)},onChange:t=>{let n=t.target.value;(n=n.replace(",",".")).startsWith(".")&&(n=`0${n}`),!(n.length>10)&&(Number.isNaN(Number(n))||(n.startsWith("0")&&!n.startsWith("0.")?e.setTokenAmount(n.slice(1)):e.setTokenAmount(n)))},style:{border:"none",fontSize:l.J.lg,boxShadow:"none",borderRadius:"0",padding:"0",paddingBlock:"2px",fontWeight:600,textAlign:"left",width:(()=>{let t=(0,c.Z)(Number(e.tokenAmount),6).toString(),n=t.replace(".","").length;return t.includes(".")&&(n+=.3),`calc(${Math.max(1,n)}ch + 2px)`})()}}),(0,o.jsxs)(f.mc,{flex:"row",gap:"xxs",center:"y",children:[(0,o.jsx)(w.C,{token:e.selectedToken,chain:e.selectedChain,size:"md",color:"secondaryText"}),(0,o.jsx)(H,{chain:e.selectedChain,client:e.client,size:"sm",token:e.selectedToken})]}),(0,o.jsx)(tx,{chain:e.selectedChain,client:e.client,tokenAmount:e.tokenAmount,token:e.selectedToken,size:"sm"})]}),(0,o.jsx)(x.R,{chain:e.selectedChain,client:e.client,size:"sm",short:!0})]})})}function tZ(e){let{setTokenAmount:t,setToChain:n,setToToken:s,setFromChain:i,setFromToken:r,payerAccount:d,client:c,tokenAmount:l,payOptions:u,toToken:m,toChain:h,supportedDestinations:p,enabledPaymentMethods:x}=e,{buyWithCryptoEnabled:k,buyWithFiatEnabled:w}=x,T=!l;switch(u.mode){case"transaction":return(0,o.jsx)(ee,{supportedDestinations:p,payUiOptions:u,payerAccount:d,connectOptions:e.connectOptions,client:c,onContinue:(o,a,d)=>{t(o),n(a),i(a),r(d),s(d),w&&!k?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-from-token",backScreen:{id:"main"}})}});case"direct_payment":return(0,o.jsx)(O,{client:c,payUiOptions:u,payerAccount:d,connectOptions:e.connectOptions,supportedDestinations:p,onContinue:(o,a,d)=>{t(o),n(a),i(a),r(d),s(d),w&&!k?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-from-token",backScreen:{id:"main"}})}});default:return(0,o.jsxs)(f.mc,{px:"lg",children:[(0,o.jsx)(y.h,{y:"lg"}),(0,o.jsx)(f.rQ,{title:e.title,onBack:e.onBack}),(0,o.jsx)(y.h,{y:"xl"}),(0,o.jsx)(ty,{value:l,onChange:async n=>{e.setHasEditedAmount(!0),t(n)},freezeAmount:u.prefillBuy?.allowEdits?.amount===!1,freezeChainAndToken:u.prefillBuy?.allowEdits?.chain===!1&&u.prefillBuy?.allowEdits?.token===!1||!1!==u.buyWithCrypto&&u.buyWithCrypto?.prefillSource?.allowEdits?.token===!1&&u.buyWithCrypto?.prefillSource?.allowEdits?.chain===!1,token:m,chain:h,onSelectToken:e.onSelectBuyToken,client:e.client}),(0,o.jsx)(y.h,{y:"md"}),(0,o.jsx)(f.mc,{flex:"column",gap:"sm",children:d?(0,o.jsx)(g.$n,{variant:"accent",fullWidth:!0,disabled:T,"data-disabled":T,onClick:()=>{w&&!k?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-from-token",backScreen:{id:"main"}}),(0,a.G)({event:"choose_payment_method_fund_wallet_mode",client:c,walletAddress:d.address,toChainId:h.id,toToken:(0,v.rk)(m)?void 0:m.address})},children:"Continue"}):(0,o.jsx)("div",{children:(0,o.jsx)(j.p,{...e.connectOptions,client:e.client,theme:e.theme,connectButton:{style:{width:"100%"}}})})}),(0,o.jsx)(y.h,{y:"lg"}),!1!==u.showThirdwebBranding&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(b.B,{link:"https://playground.thirdweb.com/connect/pay?utm_source=ub_text"}),(0,o.jsx)(y.h,{y:"sm"})]})]})}}function tX(e){return(0,o.jsxs)(f.mc,{children:[(0,o.jsx)(f.mc,{p:"lg",children:(0,o.jsx)(f.rQ,{title:e.title,onBack:e.onBack})}),(0,o.jsxs)(f.mc,{px:"lg",style:{paddingBottom:l.YK.lg},children:[(0,o.jsx)(y.h,{y:"xs"}),(0,o.jsx)(tJ,{selectedToken:e.selectedToken,selectedChain:e.selectedChain,tokenAmount:e.tokenAmount,setTokenAmount:e.setTokenAmount,client:e.client,disabled:e.disabled}),(0,o.jsx)(y.h,{y:"sm"}),(0,o.jsx)(f.N1,{}),(0,o.jsx)(y.h,{y:"sm"}),e.children]})]})}function t0(e,t,n){if(n)return n;let o={},s=!1===t.buyWithFiat,i=!1===t.buyWithCrypto;for(let t of e)o[t.chain.id]=t.tokens.filter(e=>e.address!==d.cF&&(void 0===e.buyWithCryptoEnabled&&void 0===e.buyWithFiatEnabled||!!e.buyWithCryptoEnabled&&!!e.buyWithFiatEnabled||(!!e.buyWithCryptoEnabled||!s)&&(!!e.buyWithFiatEnabled||!i)));return o}function t1(e){return(0,o.jsx)(T.Hh,{client:e.client,connectLocale:e.connectLocale,showTabs:!1,onBack:e.goBack,chains:e.chains,closeModal:e.goBack,networkSelector:{renderChain:t=>(0,o.jsx)(T.O$,{chain:t.chain,confirming:!1,switchingFailed:!1,onClick:()=>{e.setChain(t.chain),e.goBack()},client:e.client,connectLocale:e.connectLocale})}})}},91764:(e,t,n)=>{n.d(t,{S:()=>d});var o=n(19131),s=n(3702),i=n(66971);let a=[{type:"address",name:"spender"},{type:"uint256",name:"value"}],r=[{type:"bool"}];function d(e){var t={contract:e.contract,asyncParams:async()=>{let t;if("amount"in e){let{decimals:s}=await n.e(18872).then(n.bind(n,18872)),i=await s(e).catch(()=>18);t=(0,o.J1)(e.amount.toString(),i)}else t=e.amountWei;return{spender:e.spender,value:t,overrides:{erc20Value:{amountWei:t,tokenAddress:e.contract.address}}}}};let d=(0,i.O)(async()=>"asyncParams"in t?await t.asyncParams():t);return(0,s.m)({contract:t.contract,method:["0x095ea7b3",a,r],params:async()=>{let e=await d();return[e.spender,e.value]},value:async()=>(await d()).overrides?.value,accessList:async()=>(await d()).overrides?.accessList,gas:async()=>(await d()).overrides?.gas,gasPrice:async()=>(await d()).overrides?.gasPrice,maxFeePerGas:async()=>(await d()).overrides?.maxFeePerGas,maxPriorityFeePerGas:async()=>(await d()).overrides?.maxPriorityFeePerGas,nonce:async()=>(await d()).overrides?.nonce,extraGas:async()=>(await d()).overrides?.extraGas,erc20Value:async()=>(await d()).overrides?.erc20Value,authorizationList:async()=>(await d()).overrides?.authorizationList})}}}]);